{"ast":null,"code":"import React,{useState,useEffect,useMemo,useCallback}from'react';import{Container,Paper,Typography,Box,Avatar,List,ListItem,ListItemText,Divider,Button,Dialog,DialogTitle,DialogContent,DialogActions,TextField,Grid,Switch,FormControlLabel,IconButton,Card,CardContent,ListItemIcon,Chip,Snackbar,Alert,Menu,MenuItem,CircularProgress}from'@mui/material';import{useNavigate}from'react-router-dom';import SaveIcon from'@mui/icons-material/Save';import AddIcon from'@mui/icons-material/Add';import LogoutIcon from'@mui/icons-material/Logout';import SettingsIcon from'@mui/icons-material/Settings';import PersonIcon from'@mui/icons-material/Person';import VerifiedUserIcon from'@mui/icons-material/VerifiedUser';import CalendarTodayIcon from'@mui/icons-material/CalendarToday';import LanguageIcon from'@mui/icons-material/Language';import LocationOnIcon from'@mui/icons-material/LocationOn';import LocationOffIcon from'@mui/icons-material/LocationOff';import MoreVertIcon from'@mui/icons-material/MoreVert';import DeleteIcon from'@mui/icons-material/Delete';import EditIcon from'@mui/icons-material/Edit';import{createAuthAxios}from'../../utils/auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AUTH_SERVICE_URL=process.env.AUTH_SERVICE_URL||'https://ordermanagersystem-auth-service.onrender.com';const Profile=()=>{var _user$username,_user$username$;const navigate=useNavigate();const[user,setUser]=useState(null);const[addresses,setAddresses]=useState([]);const[preferencesForm,setPreferencesForm]=useState({language:'zh_TW',currency:'TWD',theme:'light',notification_email:true,notification_sms:false});const[openAddressDialog,setOpenAddressDialog]=useState(false);const[addressForm,setAddressForm]=useState({name:'',phone:'',postal_code:'',city:'',district:'',street:'',is_default:false});const[editingAddressIndex,setEditingAddressIndex]=useState(null);const[snackbar,setSnackbar]=useState({open:false,message:'',severity:'success'});const[anchorEl,setAnchorEl]=useState(null);const[selectedAddress,setSelectedAddress]=useState(null);const[deleteConfirmOpen,setDeleteConfirmOpen]=useState(false);const[isLoading,setIsLoading]=useState(true);// 使用 useMemo 創建 authAxios 實例，避免每次重新渲染都創建新實例\nconst authAxios=useMemo(()=>createAuthAxios(navigate),[navigate]);// 將 fetchUserData 包裝在 useCallback 中以記憶化函數\nconst fetchUserData=useCallback(async()=>{try{setIsLoading(true);const token=localStorage.getItem('userToken');console.log('當前 token:',token?'存在':'不存在');// 獲取用戶基本資料 - 使用 authAxios 替代直接的 axios\nconst userResponse=await authAxios.get(`${AUTH_SERVICE_URL}/api/v1/user/`);console.log('用戶資料回應:',userResponse.data);setUser(userResponse.data);// 使用 API 返回的數據更新用戶資料\n// 獲取用戶偏好設定 - 使用 authAxios 替代直接的 axios\nconst preferencesResponse=await authAxios.get(`${AUTH_SERVICE_URL}/api/v1/user/preferences`);setPreferencesForm(preferencesResponse.data);// 獲取用戶地址 - 使用 authAxios 替代直接的 axios\nconst addressesResponse=await authAxios.get(`${AUTH_SERVICE_URL}/api/v1/user/addresses`);console.log('地址資料回應:',addressesResponse);setAddresses(addressesResponse.data);// 在成功獲取用戶數據後添加這行\nlocalStorage.setItem('userData',JSON.stringify(userResponse.data));}catch(error){console.error('獲取用戶資料失敗:',error);// 添加更詳細的錯誤處理\nif(error.response){console.error('錯誤狀態:',error.response.status);console.error('錯誤數據:',error.response.data);}}finally{setIsLoading(false);}},[authAxios]);// 添加 authAxios 作為依賴\nuseEffect(()=>{const token=localStorage.getItem('userToken');if(!token){navigate('/login');return;}fetchUserData();},[navigate,fetchUserData]);// 添加 fetchUserData 作為依賴\nconst handleLogout=()=>{localStorage.removeItem('userToken');localStorage.removeItem('refreshToken');// 同時移除 refreshToken\nlocalStorage.removeItem('userData');navigate('/login');};const handlePreferencesSubmit=async()=>{try{// 使用 authAxios 替代直接的 axios\nconst response=await authAxios.put(`${AUTH_SERVICE_URL}/api/v1/user/preferences`,preferencesForm);if(response.data){setSnackbar({open:true,message:'偏好設定已更新成功！',severity:'success'});}}catch(error){console.error('更新偏好設定失敗:',error);setSnackbar({open:true,message:'更新偏好設定失敗，請稍後再試',severity:'error'});}};const handleAddressClick=(address,index)=>{setAddressForm(address);setEditingAddressIndex(index);setOpenAddressDialog(true);};const handleAddNewAddress=()=>{setAddressForm({name:'',phone:'',postal_code:'',city:'',district:'',street:'',is_default:false});setEditingAddressIndex(null);setOpenAddressDialog(true);};const handleAddressClose=()=>{setOpenAddressDialog(false);setEditingAddressIndex(null);};const handleAddressMenuClick=(event,address)=>{event.stopPropagation();setAnchorEl(event.currentTarget);setSelectedAddress(address);};const handleAddressMenuClose=()=>{setAnchorEl(null);setSelectedAddress(null);};const handleEditAddress=()=>{handleAddressMenuClose();const addressIndex=addresses.findIndex(addr=>addr.id===selectedAddress.id);handleAddressClick(selectedAddress,addressIndex);};const handleDeleteAddress=async()=>{try{// 使用 authAxios 替代直接的 axios\nawait authAxios.delete(`${AUTH_SERVICE_URL}/api/v1/user/addresses/${selectedAddress.id}`);await fetchUserData();setSnackbar({open:true,message:'地址已成功刪除！',severity:'success'});}catch(error){console.error('刪除地址失敗:',error);setSnackbar({open:true,message:'刪除地址失敗，請稍後再試',severity:'error'});}handleAddressMenuClose();setDeleteConfirmOpen(false);};const handleAddressSubmit=async()=>{try{let response;if(editingAddressIndex!==null){// 更新現有地址 - 使用 authAxios 替代直接的 axios\nresponse=await authAxios.put(`${AUTH_SERVICE_URL}/api/v1/user/addresses/${addresses[editingAddressIndex].id}`,addressForm);}else{// 新增地址 - 使用 authAxios 替代直接的 axios\nresponse=await authAxios.post(`${AUTH_SERVICE_URL}/api/v1/user/addresses`,addressForm);}if(response.data){await fetchUserData();setOpenAddressDialog(false);setSnackbar({open:true,message:`地址已成功${editingAddressIndex!==null?'更新':'新增'}！`,severity:'success'});}}catch(error){console.error('更新地址失敗:',error);setSnackbar({open:true,message:`${editingAddressIndex!==null?'更新':'新增'}地址失敗，請稍後再試`,severity:'error'});}};if(isLoading){return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh',backgroundColor:'background.default'},children:/*#__PURE__*/_jsx(CircularProgress,{size:60,thickness:4})});}if(!user){return/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh',flexDirection:'column',gap:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"\\u7121\\u6CD5\\u8F09\\u5165\\u7528\\u6236\\u8CC7\\u6599\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:()=>navigate('/login'),children:\"\\u91CD\\u65B0\\u767B\\u5165\"})]});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:3,mb:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',mb:4},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Avatar,{sx:{width:100,height:100,mr:3,bgcolor:'primary.main',fontSize:'2rem'},children:(_user$username=user.username)===null||_user$username===void 0?void 0:(_user$username$=_user$username[0])===null||_user$username$===void 0?void 0:_user$username$.toUpperCase()}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:user.username}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",color:\"text.secondary\",children:user.email})]})]}),/*#__PURE__*/_jsx(IconButton,{color:\"error\",onClick:handleLogout,sx:{bgcolor:'action.hover','&:hover':{bgcolor:'error.light'}},children:/*#__PURE__*/_jsx(LogoutIcon,{})})]}),/*#__PURE__*/_jsxs(List,{sx:{bgcolor:'background.paper',borderRadius:1},children:[/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(PersonIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\\u6703\\u54E1\\u89D2\\u8272\",secondary:user.role==='admin'?'管理員':'一般會員'})]}),/*#__PURE__*/_jsx(Divider,{component:\"li\"}),/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(VerifiedUserIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\\u5E33\\u865F\\u72C0\\u614B\",secondary:user.status==='active'?'正常':'停用'})]}),/*#__PURE__*/_jsx(Divider,{component:\"li\"}),/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(CalendarTodayIcon,{})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\\u8A3B\\u518A\\u6642\\u9593\",secondary:new Date(user.created_at).toLocaleString()})]})]})]}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:3,mb:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(SettingsIcon,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{fontWeight:'medium'},children:\"\\u500B\\u4EBA\\u5316\\u8A2D\\u5B9A\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handlePreferencesSubmit,startIcon:/*#__PURE__*/_jsx(SaveIcon,{}),size:\"small\",children:\"\\u5132\\u5B58\\u8A2D\\u5B9A\"})]}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:[{icon:/*#__PURE__*/_jsx(LanguageIcon,{}),title:'語言',value:preferencesForm.language,options:[{value:'zh_TW',label:'繁體中文'},{value:'en',label:'English'}],onChange:e=>setPreferencesForm({...preferencesForm,language:e.target.value})},{icon:/*#__PURE__*/_jsx(LanguageIcon,{}),title:'幣別',value:preferencesForm.currency,options:[{value:'TWD',label:'新台幣 (TWD)'},{value:'USD',label:'美元 (USD)'}],onChange:e=>setPreferencesForm({...preferencesForm,currency:e.target.value})},{icon:/*#__PURE__*/_jsx(LanguageIcon,{}),title:'主題',value:preferencesForm.theme,options:[{value:'light',label:'淺色'},{value:'dark',label:'深色'}],onChange:e=>setPreferencesForm({...preferencesForm,theme:e.target.value})},{icon:/*#__PURE__*/_jsx(LanguageIcon,{}),title:'通知設定',value:preferencesForm.notification_email.toString(),options:[{value:'true',label:'啟用'},{value:'false',label:'停用'}],onChange:e=>{const newValue=e.target.value==='true';setPreferencesForm(prev=>({...prev,notification_email:newValue}));}}].map((setting,index)=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{sx:{height:'100%'},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1,mb:2},children:[setting.icon,/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",children:setting.title})]}),/*#__PURE__*/_jsx(TextField,{select:true,fullWidth:true,size:\"small\",value:setting.value,onChange:setting.onChange,SelectProps:{native:true},children:setting.options.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value))})]})})},index))})]}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:3},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(LocationOnIcon,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{fontWeight:'medium'},children:\"\\u6536\\u8CA8\\u5730\\u5740\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleAddNewAddress,startIcon:/*#__PURE__*/_jsx(AddIcon,{}),size:\"small\",children:\"\\u65B0\\u589E\\u5730\\u5740\"})]}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:addresses.length>0?addresses.map((address,index)=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsx(Card,{sx:{cursor:'pointer',transition:'all 0.3s','&:hover':{transform:'translateY(-4px)',boxShadow:3}},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:address.name}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[address.is_default&&/*#__PURE__*/_jsx(Chip,{label:\"\\u9810\\u8A2D\",color:\"primary\",size:\"small\"}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:e=>handleAddressMenuClick(e,address),children:/*#__PURE__*/_jsx(MoreVertIcon,{})})]})]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:address.phone}),/*#__PURE__*/_jsxs(Typography,{color:\"text.secondary\",variant:\"body2\",children:[address.postal_code,\" \",address.city,address.district,address.street]})]})})},index)):/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center',py:4,bgcolor:'background.paper',borderRadius:1},children:[/*#__PURE__*/_jsx(LocationOffIcon,{sx:{fontSize:48,color:'text.secondary',mb:2}}),/*#__PURE__*/_jsx(Typography,{color:\"text.secondary\",children:\"\\u5C1A\\u672A\\u65B0\\u589E\\u5730\\u5740\"})]})})})]}),/*#__PURE__*/_jsxs(Dialog,{open:openAddressDialog,onClose:handleAddressClose,maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:editingAddressIndex!==null?'編輯地址':'新增地址'}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,margin:\"dense\",label:\"\\u5730\\u5740\\u540D\\u7A31\",placeholder:\"\\u4F8B\\uFF1A\\u516C\\u53F8\\u3001\\u5BB6\",fullWidth:true,value:addressForm.name,onChange:e=>setAddressForm({...addressForm,name:e.target.value})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,margin:\"dense\",label:\"\\u806F\\u7D61\\u96FB\\u8A71\",fullWidth:true,value:addressForm.phone,onChange:e=>setAddressForm({...addressForm,phone:e.target.value})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,margin:\"dense\",label:\"\\u90F5\\u905E\\u5340\\u865F\",fullWidth:true,value:addressForm.postal_code,onChange:e=>setAddressForm({...addressForm,postal_code:e.target.value})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,margin:\"dense\",label:\"\\u57CE\\u5E02\",fullWidth:true,value:addressForm.city,onChange:e=>setAddressForm({...addressForm,city:e.target.value})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,children:/*#__PURE__*/_jsx(TextField,{required:true,margin:\"dense\",label:\"\\u5340\\u57DF\",fullWidth:true,value:addressForm.district,onChange:e=>setAddressForm({...addressForm,district:e.target.value})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{required:true,margin:\"dense\",label:\"\\u8857\\u9053\\u5730\\u5740\",fullWidth:true,value:addressForm.street,onChange:e=>setAddressForm({...addressForm,street:e.target.value})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:addressForm.is_default,onChange:e=>setAddressForm({...addressForm,is_default:e.target.checked})}),label:\"\\u8A2D\\u70BA\\u9810\\u8A2D\\u5730\\u5740\"})})]})})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleAddressClose,children:\"\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(Button,{onClick:handleAddressSubmit,variant:\"contained\",children:\"\\u5132\\u5B58\"})]})]}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorEl,open:Boolean(anchorEl),onClose:handleAddressMenuClose,children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleEditAddress,children:[/*#__PURE__*/_jsx(EditIcon,{fontSize:\"small\",sx:{mr:1}}),\"\\u7DE8\\u8F2F\\u5730\\u5740\"]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>setDeleteConfirmOpen(true),sx:{color:'error.main'},children:[/*#__PURE__*/_jsx(DeleteIcon,{fontSize:\"small\",sx:{mr:1}}),\"\\u522A\\u9664\\u5730\\u5740\"]})]}),/*#__PURE__*/_jsxs(Dialog,{open:deleteConfirmOpen,onClose:()=>setDeleteConfirmOpen(false),children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"\\u78BA\\u8A8D\\u522A\\u9664\\u5730\\u5740\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(Typography,{children:\"\\u78BA\\u5B9A\\u8981\\u522A\\u9664\\u9019\\u500B\\u5730\\u5740\\u55CE\\uFF1F\\u6B64\\u64CD\\u4F5C\\u7121\\u6CD5\\u5FA9\\u539F\\u3002\"})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setDeleteConfirmOpen(false),children:\"\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(Button,{onClick:handleDeleteAddress,color:\"error\",variant:\"contained\",children:\"\\u522A\\u9664\"})]})]}),/*#__PURE__*/_jsx(Snackbar,{open:snackbar.open,autoHideDuration:2000,onClose:()=>setSnackbar({...snackbar,open:false}),anchorOrigin:{vertical:'top',horizontal:'center'},children:/*#__PURE__*/_jsx(Alert,{onClose:()=>setSnackbar({...snackbar,open:false}),severity:snackbar.severity,sx:{width:'100%'},children:snackbar.message})})]});};export default Profile;","map":{"version":3,"names":["React","useState","useEffect","useMemo","useCallback","Container","Paper","Typography","Box","Avatar","List","ListItem","ListItemText","Divider","Button","Dialog","DialogTitle","DialogContent","DialogActions","TextField","Grid","Switch","FormControlLabel","IconButton","Card","CardContent","ListItemIcon","Chip","Snackbar","Alert","Menu","MenuItem","CircularProgress","useNavigate","SaveIcon","AddIcon","LogoutIcon","SettingsIcon","PersonIcon","VerifiedUserIcon","CalendarTodayIcon","LanguageIcon","LocationOnIcon","LocationOffIcon","MoreVertIcon","DeleteIcon","EditIcon","createAuthAxios","jsx","_jsx","jsxs","_jsxs","AUTH_SERVICE_URL","process","env","Profile","_user$username","_user$username$","navigate","user","setUser","addresses","setAddresses","preferencesForm","setPreferencesForm","language","currency","theme","notification_email","notification_sms","openAddressDialog","setOpenAddressDialog","addressForm","setAddressForm","name","phone","postal_code","city","district","street","is_default","editingAddressIndex","setEditingAddressIndex","snackbar","setSnackbar","open","message","severity","anchorEl","setAnchorEl","selectedAddress","setSelectedAddress","deleteConfirmOpen","setDeleteConfirmOpen","isLoading","setIsLoading","authAxios","fetchUserData","token","localStorage","getItem","console","log","userResponse","get","data","preferencesResponse","addressesResponse","setItem","JSON","stringify","error","response","status","handleLogout","removeItem","handlePreferencesSubmit","put","handleAddressClick","address","index","handleAddNewAddress","handleAddressClose","handleAddressMenuClick","event","stopPropagation","currentTarget","handleAddressMenuClose","handleEditAddress","addressIndex","findIndex","addr","id","handleDeleteAddress","delete","handleAddressSubmit","post","sx","display","justifyContent","alignItems","minHeight","backgroundColor","children","size","thickness","flexDirection","gap","variant","color","onClick","maxWidth","mt","mb","elevation","p","width","height","mr","bgcolor","fontSize","username","toUpperCase","gutterBottom","email","borderRadius","primary","secondary","role","component","Date","created_at","toLocaleString","fontWeight","startIcon","container","spacing","icon","title","value","options","label","onChange","e","target","toString","newValue","prev","map","setting","item","xs","sm","md","select","fullWidth","SelectProps","native","option","length","cursor","transition","transform","boxShadow","textAlign","py","onClose","required","margin","placeholder","control","checked","Boolean","autoHideDuration","anchorOrigin","vertical","horizontal"],"sources":["/Users/sumingkai/Documents/OrderManagerSystem/frontend/src/pages/Store/Profile.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from 'react';\nimport {\n    Container,\n    Paper,\n    Typography,\n    Box,\n    Avatar,\n    List,\n    ListItem,\n    ListItemText,\n    Divider,\n    Button,\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    DialogActions,\n    TextField,\n    Grid,\n    Switch,\n    FormControlLabel,\n    IconButton,\n    Card,\n    CardContent,\n    ListItemIcon,\n    Chip,\n    Snackbar,\n    Alert,\n    Menu,\n    MenuItem,\n    CircularProgress,\n} from '@mui/material';\nimport { useNavigate } from 'react-router-dom';\nimport SaveIcon from '@mui/icons-material/Save';\nimport AddIcon from '@mui/icons-material/Add';\nimport LogoutIcon from '@mui/icons-material/Logout';\nimport SettingsIcon from '@mui/icons-material/Settings';\nimport PersonIcon from '@mui/icons-material/Person';\nimport VerifiedUserIcon from '@mui/icons-material/VerifiedUser';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport LanguageIcon from '@mui/icons-material/Language';\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\nimport LocationOffIcon from '@mui/icons-material/LocationOff';\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\nimport DeleteIcon from '@mui/icons-material/Delete';\nimport EditIcon from '@mui/icons-material/Edit';\nimport { createAuthAxios } from '../../utils/auth';\n\nconst AUTH_SERVICE_URL = process.env.AUTH_SERVICE_URL || 'https://ordermanagersystem-auth-service.onrender.com';\n\nconst Profile = () => {\n    const navigate = useNavigate();\n    const [user, setUser] = useState(null);\n    const [addresses, setAddresses] = useState([]);\n    const [preferencesForm, setPreferencesForm] = useState({\n        language: 'zh_TW',\n        currency: 'TWD',\n        theme: 'light',\n        notification_email: true,\n        notification_sms: false\n    });\n    const [openAddressDialog, setOpenAddressDialog] = useState(false);\n    const [addressForm, setAddressForm] = useState({\n        name: '',\n        phone: '',\n        postal_code: '',\n        city: '',\n        district: '',\n        street: '',\n        is_default: false\n    });\n    const [editingAddressIndex, setEditingAddressIndex] = useState(null);\n    const [snackbar, setSnackbar] = useState({\n        open: false,\n        message: '',\n        severity: 'success'\n    });\n    const [anchorEl, setAnchorEl] = useState(null);\n    const [selectedAddress, setSelectedAddress] = useState(null);\n    const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false);\n    const [isLoading, setIsLoading] = useState(true);\n\n    // 使用 useMemo 創建 authAxios 實例，避免每次重新渲染都創建新實例\n    const authAxios = useMemo(() => createAuthAxios(navigate), [navigate]);\n\n    // 將 fetchUserData 包裝在 useCallback 中以記憶化函數\n    const fetchUserData = useCallback(async () => {\n        try {\n            setIsLoading(true);\n            const token = localStorage.getItem('userToken');\n            console.log('當前 token:', token ? '存在' : '不存在');\n\n            // 獲取用戶基本資料 - 使用 authAxios 替代直接的 axios\n            const userResponse = await authAxios.get(`${AUTH_SERVICE_URL}/api/v1/user/`);\n            console.log('用戶資料回應:', userResponse.data);\n            setUser(userResponse.data); // 使用 API 返回的數據更新用戶資料\n\n            // 獲取用戶偏好設定 - 使用 authAxios 替代直接的 axios\n            const preferencesResponse = await authAxios.get(`${AUTH_SERVICE_URL}/api/v1/user/preferences`);\n            setPreferencesForm(preferencesResponse.data);\n\n            // 獲取用戶地址 - 使用 authAxios 替代直接的 axios\n            const addressesResponse = await authAxios.get(`${AUTH_SERVICE_URL}/api/v1/user/addresses`);\n            console.log('地址資料回應:', addressesResponse);\n            setAddresses(addressesResponse.data);\n\n            // 在成功獲取用戶數據後添加這行\n            localStorage.setItem('userData', JSON.stringify(userResponse.data));\n        } catch (error) {\n            console.error('獲取用戶資料失敗:', error);\n            // 添加更詳細的錯誤處理\n            if (error.response) {\n                console.error('錯誤狀態:', error.response.status);\n                console.error('錯誤數據:', error.response.data);\n            }\n        } finally {\n            setIsLoading(false);\n        }\n    }, [authAxios]); // 添加 authAxios 作為依賴\n\n    useEffect(() => {\n        const token = localStorage.getItem('userToken');\n        if (!token) {\n            navigate('/login');\n            return;\n        }\n\n        fetchUserData();\n    }, [navigate, fetchUserData]); // 添加 fetchUserData 作為依賴\n\n    const handleLogout = () => {\n        localStorage.removeItem('userToken');\n        localStorage.removeItem('refreshToken'); // 同時移除 refreshToken\n        localStorage.removeItem('userData');\n        navigate('/login');\n    };\n\n    const handlePreferencesSubmit = async () => {\n        try {\n            // 使用 authAxios 替代直接的 axios\n            const response = await authAxios.put(\n                `${AUTH_SERVICE_URL}/api/v1/user/preferences`,\n                preferencesForm\n            );\n\n            if (response.data) {\n                setSnackbar({\n                    open: true,\n                    message: '偏好設定已更新成功！',\n                    severity: 'success'\n                });\n            }\n        } catch (error) {\n            console.error('更新偏好設定失敗:', error);\n            setSnackbar({\n                open: true,\n                message: '更新偏好設定失敗，請稍後再試',\n                severity: 'error'\n            });\n        }\n    };\n\n    const handleAddressClick = (address, index) => {\n        setAddressForm(address);\n        setEditingAddressIndex(index);\n        setOpenAddressDialog(true);\n    };\n\n    const handleAddNewAddress = () => {\n        setAddressForm({\n            name: '',\n            phone: '',\n            postal_code: '',\n            city: '',\n            district: '',\n            street: '',\n            is_default: false\n        });\n        setEditingAddressIndex(null);\n        setOpenAddressDialog(true);\n    };\n\n    const handleAddressClose = () => {\n        setOpenAddressDialog(false);\n        setEditingAddressIndex(null);\n    };\n\n    const handleAddressMenuClick = (event, address) => {\n        event.stopPropagation();\n        setAnchorEl(event.currentTarget);\n        setSelectedAddress(address);\n    };\n\n    const handleAddressMenuClose = () => {\n        setAnchorEl(null);\n        setSelectedAddress(null);\n    };\n\n    const handleEditAddress = () => {\n        handleAddressMenuClose();\n        const addressIndex = addresses.findIndex(addr => addr.id === selectedAddress.id);\n        handleAddressClick(selectedAddress, addressIndex);\n    };\n\n    const handleDeleteAddress = async () => {\n        try {\n            // 使用 authAxios 替代直接的 axios\n            await authAxios.delete(\n                `${AUTH_SERVICE_URL}/api/v1/user/addresses/${selectedAddress.id}`\n            );\n\n            await fetchUserData();\n            setSnackbar({\n                open: true,\n                message: '地址已成功刪除！',\n                severity: 'success'\n            });\n        } catch (error) {\n            console.error('刪除地址失敗:', error);\n            setSnackbar({\n                open: true,\n                message: '刪除地址失敗，請稍後再試',\n                severity: 'error'\n            });\n        }\n        handleAddressMenuClose();\n        setDeleteConfirmOpen(false);\n    };\n\n    const handleAddressSubmit = async () => {\n        try {\n            let response;\n            if (editingAddressIndex !== null) {\n                // 更新現有地址 - 使用 authAxios 替代直接的 axios\n                response = await authAxios.put(\n                    `${AUTH_SERVICE_URL}/api/v1/user/addresses/${addresses[editingAddressIndex].id}`,\n                    addressForm\n                );\n            } else {\n                // 新增地址 - 使用 authAxios 替代直接的 axios\n                response = await authAxios.post(\n                    `${AUTH_SERVICE_URL}/api/v1/user/addresses`,\n                    addressForm\n                );\n            }\n\n            if (response.data) {\n                await fetchUserData();\n                setOpenAddressDialog(false);\n                setSnackbar({\n                    open: true,\n                    message: `地址已成功${editingAddressIndex !== null ? '更新' : '新增'}！`,\n                    severity: 'success'\n                });\n            }\n        } catch (error) {\n            console.error('更新地址失敗:', error);\n            setSnackbar({\n                open: true,\n                message: `${editingAddressIndex !== null ? '更新' : '新增'}地址失敗，請稍後再試`,\n                severity: 'error'\n            });\n        }\n    };\n\n    if (isLoading) {\n        return (\n            <Box\n                sx={{\n                    display: 'flex',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    minHeight: '100vh',\n                    backgroundColor: 'background.default'\n                }}\n            >\n                <CircularProgress size={60} thickness={4} />\n            </Box>\n        );\n    }\n\n    if (!user) {\n        return (\n            <Box\n                sx={{\n                    display: 'flex',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    minHeight: '100vh',\n                    flexDirection: 'column',\n                    gap: 2\n                }}\n            >\n                <Typography variant=\"h6\" color=\"text.secondary\">\n                    無法載入用戶資料\n                </Typography>\n                <Button\n                    variant=\"contained\"\n                    onClick={() => navigate('/login')}\n                >\n                    重新登入\n                </Button>\n            </Box>\n        );\n    }\n\n    return (\n        <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\n            <Paper elevation={3} sx={{ p: 3, mb: 3 }}>\n                <Box sx={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'flex-start',\n                    mb: 4\n                }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                        <Avatar\n                            sx={{\n                                width: 100,\n                                height: 100,\n                                mr: 3,\n                                bgcolor: 'primary.main',\n                                fontSize: '2rem',\n                            }}\n                        >\n                            {user.username?.[0]?.toUpperCase()}\n                        </Avatar>\n                        <Box>\n                            <Typography variant=\"h4\" gutterBottom>\n                                {user.username}\n                            </Typography>\n                            <Typography variant=\"subtitle1\" color=\"text.secondary\">\n                                {user.email}\n                            </Typography>\n                        </Box>\n                    </Box>\n\n                    <IconButton\n                        color=\"error\"\n                        onClick={handleLogout}\n                        sx={{\n                            bgcolor: 'action.hover',\n                            '&:hover': { bgcolor: 'error.light' }\n                        }}\n                    >\n                        <LogoutIcon />\n                    </IconButton>\n                </Box>\n\n                <List sx={{ bgcolor: 'background.paper', borderRadius: 1 }}>\n                    <ListItem>\n                        <ListItemIcon>\n                            <PersonIcon />\n                        </ListItemIcon>\n                        <ListItemText\n                            primary=\"會員角色\"\n                            secondary={user.role === 'admin' ? '管理員' : '一般會員'}\n                        />\n                    </ListItem>\n                    <Divider component=\"li\" />\n                    <ListItem>\n                        <ListItemIcon>\n                            <VerifiedUserIcon />\n                        </ListItemIcon>\n                        <ListItemText\n                            primary=\"帳號狀態\"\n                            secondary={user.status === 'active' ? '正常' : '停用'}\n                        />\n                    </ListItem>\n                    <Divider component=\"li\" />\n                    <ListItem>\n                        <ListItemIcon>\n                            <CalendarTodayIcon />\n                        </ListItemIcon>\n                        <ListItemText\n                            primary=\"註冊時間\"\n                            secondary={new Date(user.created_at).toLocaleString()}\n                        />\n                    </ListItem>\n                </List>\n            </Paper>\n\n            <Paper elevation={3} sx={{ p: 3, mb: 3 }}>\n                <Box sx={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    mb: 2\n                }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                        <SettingsIcon color=\"primary\" />\n                        <Typography variant=\"h5\" sx={{ fontWeight: 'medium' }}>\n                            個人化設定\n                        </Typography>\n                    </Box>\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        onClick={handlePreferencesSubmit}\n                        startIcon={<SaveIcon />}\n                        size=\"small\"\n                    >\n                        儲存設定\n                    </Button>\n                </Box>\n\n                <Grid container spacing={2}>\n                    {[\n                        {\n                            icon: <LanguageIcon />,\n                            title: '語言',\n                            value: preferencesForm.language,\n                            options: [\n                                { value: 'zh_TW', label: '繁體中文' },\n                                { value: 'en', label: 'English' }\n                            ],\n                            onChange: (e) => setPreferencesForm({ ...preferencesForm, language: e.target.value })\n                        },\n                        {\n                            icon: <LanguageIcon />,\n                            title: '幣別',\n                            value: preferencesForm.currency,\n                            options: [\n                                { value: 'TWD', label: '新台幣 (TWD)' },\n                                { value: 'USD', label: '美元 (USD)' }\n                            ],\n                            onChange: (e) => setPreferencesForm({ ...preferencesForm, currency: e.target.value })\n                        },\n                        {\n                            icon: <LanguageIcon />,\n                            title: '主題',\n                            value: preferencesForm.theme,\n                            options: [\n                                { value: 'light', label: '淺色' },\n                                { value: 'dark', label: '深色' }\n                            ],\n                            onChange: (e) => setPreferencesForm({ ...preferencesForm, theme: e.target.value })\n                        },\n                        {\n                            icon: <LanguageIcon />,\n                            title: '通知設定',\n                            value: preferencesForm.notification_email.toString(),\n                            options: [\n                                { value: 'true', label: '啟用' },\n                                { value: 'false', label: '停用' }\n                            ],\n                            onChange: (e) => {\n                                const newValue = e.target.value === 'true';\n                                setPreferencesForm(prev => ({\n                                    ...prev,\n                                    notification_email: newValue\n                                }));\n                            }\n                        },\n                    ].map((setting, index) => (\n                        <Grid item xs={12} sm={6} md={3} key={index}>\n                            <Card sx={{ height: '100%' }}>\n                                <CardContent>\n                                    <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 2 }}>\n                                        {setting.icon}\n                                        <Typography variant=\"subtitle1\">\n                                            {setting.title}\n                                        </Typography>\n                                    </Box>\n                                    <TextField\n                                        select\n                                        fullWidth\n                                        size=\"small\"\n                                        value={setting.value}\n                                        onChange={setting.onChange}\n                                        SelectProps={{ native: true }}\n                                    >\n                                        {setting.options.map(option => (\n                                            <option key={option.value} value={option.value}>\n                                                {option.label}\n                                            </option>\n                                        ))}\n                                    </TextField>\n                                </CardContent>\n                            </Card>\n                        </Grid>\n                    ))}\n                </Grid>\n            </Paper>\n\n            <Paper elevation={3} sx={{ p: 3 }}>\n                <Box sx={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    mb: 2\n                }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                        <LocationOnIcon color=\"primary\" />\n                        <Typography variant=\"h5\" sx={{ fontWeight: 'medium' }}>\n                            收貨地址\n                        </Typography>\n                    </Box>\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        onClick={handleAddNewAddress}\n                        startIcon={<AddIcon />}\n                        size=\"small\"\n                    >\n                        新增地址\n                    </Button>\n                </Box>\n\n                <Grid container spacing={2}>\n                    {addresses.length > 0 ? (\n                        addresses.map((address, index) => (\n                            <Grid item xs={12} sm={6} md={4} key={index}>\n                                <Card\n                                    sx={{\n                                        cursor: 'pointer',\n                                        transition: 'all 0.3s',\n                                        '&:hover': {\n                                            transform: 'translateY(-4px)',\n                                            boxShadow: 3\n                                        }\n                                    }}\n                                >\n                                    <CardContent>\n                                        <Box sx={{\n                                            display: 'flex',\n                                            justifyContent: 'space-between',\n                                            alignItems: 'center',\n                                            mb: 1\n                                        }}>\n                                            <Typography variant=\"h6\">\n                                                {address.name}\n                                            </Typography>\n                                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                                                {address.is_default && (\n                                                    <Chip\n                                                        label=\"預設\"\n                                                        color=\"primary\"\n                                                        size=\"small\"\n                                                    />\n                                                )}\n                                                <IconButton\n                                                    size=\"small\"\n                                                    onClick={(e) => handleAddressMenuClick(e, address)}\n                                                >\n                                                    <MoreVertIcon />\n                                                </IconButton>\n                                            </Box>\n                                        </Box>\n                                        <Typography variant=\"body2\" sx={{ mb: 1 }}>\n                                            {address.phone}\n                                        </Typography>\n                                        <Typography color=\"text.secondary\" variant=\"body2\">\n                                            {address.postal_code} {address.city}{address.district}{address.street}\n                                        </Typography>\n                                    </CardContent>\n                                </Card>\n                            </Grid>\n                        ))\n                    ) : (\n                        <Grid item xs={12}>\n                            <Box\n                                sx={{\n                                    textAlign: 'center',\n                                    py: 4,\n                                    bgcolor: 'background.paper',\n                                    borderRadius: 1\n                                }}\n                            >\n                                <LocationOffIcon sx={{ fontSize: 48, color: 'text.secondary', mb: 2 }} />\n                                <Typography color=\"text.secondary\">\n                                    尚未新增地址\n                                </Typography>\n                            </Box>\n                        </Grid>\n                    )}\n                </Grid>\n            </Paper>\n\n            <Dialog open={openAddressDialog} onClose={handleAddressClose} maxWidth=\"sm\" fullWidth>\n                <DialogTitle>\n                    {editingAddressIndex !== null ? '編輯地址' : '新增地址'}\n                </DialogTitle>\n                <DialogContent>\n                    <Box sx={{ mt: 2 }}>\n                        <Grid container spacing={2}>\n                            <Grid item xs={12} sm={6}>\n                                <TextField\n                                    required\n                                    margin=\"dense\"\n                                    label=\"地址名稱\"\n                                    placeholder=\"例：公司、家\"\n                                    fullWidth\n                                    value={addressForm.name}\n                                    onChange={(e) =>\n                                        setAddressForm({ ...addressForm, name: e.target.value })\n                                    }\n                                />\n                            </Grid>\n                            <Grid item xs={12} sm={6}>\n                                <TextField\n                                    required\n                                    margin=\"dense\"\n                                    label=\"聯絡電話\"\n                                    fullWidth\n                                    value={addressForm.phone}\n                                    onChange={(e) =>\n                                        setAddressForm({ ...addressForm, phone: e.target.value })\n                                    }\n                                />\n                            </Grid>\n                            <Grid item xs={12} sm={6}>\n                                <TextField\n                                    required\n                                    margin=\"dense\"\n                                    label=\"郵遞區號\"\n                                    fullWidth\n                                    value={addressForm.postal_code}\n                                    onChange={(e) =>\n                                        setAddressForm({ ...addressForm, postal_code: e.target.value })\n                                    }\n                                />\n                            </Grid>\n                            <Grid item xs={12} sm={6}>\n                                <TextField\n                                    required\n                                    margin=\"dense\"\n                                    label=\"城市\"\n                                    fullWidth\n                                    value={addressForm.city}\n                                    onChange={(e) =>\n                                        setAddressForm({ ...addressForm, city: e.target.value })\n                                    }\n                                />\n                            </Grid>\n                            <Grid item xs={12} sm={6}>\n                                <TextField\n                                    required\n                                    margin=\"dense\"\n                                    label=\"區域\"\n                                    fullWidth\n                                    value={addressForm.district}\n                                    onChange={(e) =>\n                                        setAddressForm({ ...addressForm, district: e.target.value })\n                                    }\n                                />\n                            </Grid>\n                            <Grid item xs={12}>\n                                <TextField\n                                    required\n                                    margin=\"dense\"\n                                    label=\"街道地址\"\n                                    fullWidth\n                                    value={addressForm.street}\n                                    onChange={(e) =>\n                                        setAddressForm({ ...addressForm, street: e.target.value })\n                                    }\n                                />\n                            </Grid>\n                            <Grid item xs={12}>\n                                <FormControlLabel\n                                    control={\n                                        <Switch\n                                            checked={addressForm.is_default}\n                                            onChange={(e) =>\n                                                setAddressForm({\n                                                    ...addressForm,\n                                                    is_default: e.target.checked,\n                                                })\n                                            }\n                                        />\n                                    }\n                                    label=\"設為預設地址\"\n                                />\n                            </Grid>\n                        </Grid>\n                    </Box>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleAddressClose}>取消</Button>\n                    <Button onClick={handleAddressSubmit} variant=\"contained\">\n                        儲存\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <Menu\n                anchorEl={anchorEl}\n                open={Boolean(anchorEl)}\n                onClose={handleAddressMenuClose}\n            >\n                <MenuItem onClick={handleEditAddress}>\n                    <EditIcon fontSize=\"small\" sx={{ mr: 1 }} />\n                    編輯地址\n                </MenuItem>\n                <MenuItem\n                    onClick={() => setDeleteConfirmOpen(true)}\n                    sx={{ color: 'error.main' }}\n                >\n                    <DeleteIcon fontSize=\"small\" sx={{ mr: 1 }} />\n                    刪除地址\n                </MenuItem>\n            </Menu>\n\n            <Dialog\n                open={deleteConfirmOpen}\n                onClose={() => setDeleteConfirmOpen(false)}\n            >\n                <DialogTitle>確認刪除地址</DialogTitle>\n                <DialogContent>\n                    <Typography>\n                        確定要刪除這個地址嗎？此操作無法復原。\n                    </Typography>\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={() => setDeleteConfirmOpen(false)}>\n                        取消\n                    </Button>\n                    <Button\n                        onClick={handleDeleteAddress}\n                        color=\"error\"\n                        variant=\"contained\"\n                    >\n                        刪除\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <Snackbar\n                open={snackbar.open}\n                autoHideDuration={2000}\n                onClose={() => setSnackbar({ ...snackbar, open: false })}\n                anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n            >\n                <Alert\n                    onClose={() => setSnackbar({ ...snackbar, open: false })}\n                    severity={snackbar.severity}\n                    sx={{ width: '100%' }}\n                >\n                    {snackbar.message}\n                </Alert>\n            </Snackbar>\n        </Container>\n    );\n};\n\nexport default Profile; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}