{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{Container,Paper,Typography,Box,IconButton,Button,Divider,Grid,Card,CardContent,TextField,Alert,Collapse,Fade}from'@mui/material';import{Add as AddIcon,Remove as RemoveIcon,Delete as DeleteIcon,ShoppingCart as CartIcon,LocalShipping as ShippingIcon}from'@mui/icons-material';import{useNavigate}from'react-router-dom';import AddShoppingCartIcon from'@mui/icons-material/AddShoppingCart';import debounce from'lodash/debounce';import{createAuthAxios}from'../../utils/auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CART_SERVICE_URL='https://ordermanagersystem.onrender.com';const Cart=()=>{const navigate=useNavigate();const[cartItems,setCartItems]=useState([]);const[showAlert,setShowAlert]=useState(false);const[alertMessage,setAlertMessage]=useState('');const[alertSeverity,setAlertSeverity]=useState('success');const[pendingUpdates,setPendingUpdates]=useState({});// 使用 useMemo 記憶化 authAxios 實例\nconst authAxios=React.useMemo(()=>createAuthAxios(navigate),[navigate]);// 成功訊息顯示\nconst showSuccessMessage=useCallback(message=>{setShowAlert(true);setAlertMessage(message);setAlertSeverity('success');setTimeout(()=>setShowAlert(false),3000);},[]);// 錯誤訊息顯示\nconst showErrorMessage=useCallback(message=>{setShowAlert(true);setAlertMessage(message);setAlertSeverity('error');setTimeout(()=>setShowAlert(false),3000);},[]);// 錯誤處理函數\nconst handleError=useCallback(error=>{var _error$response,_error$response$data;// 不需要在這裡處理 401，已在 axios 實例中處理\nshowErrorMessage(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'操作失敗');},[showErrorMessage]);// 添加一個單獨的函數用於獲取購物車數據\nconst fetchCartData=useCallback(async()=>{try{console.log('開始獲取購物車...');const response=await authAxios.get(`${CART_SERVICE_URL}/api/v1/cart/`);const data=response.data;console.log('成功獲取購物車數據:',data);if(data.items){setCartItems(data.items.map(item=>({id:item.ProductID,name:item.Name,price:item.Price,quantity:item.Quantity,image:item.Image||\"https://via.placeholder.com/150\",stock:item.StockCount})));}}catch(error){console.error('獲取購物車失敗:',error);showErrorMessage(error.message);}},[authAxios,showErrorMessage]);useEffect(()=>{let isMounted=true;const controller=new AbortController();const getCartData=async()=>{try{console.log('開始獲取購物車...');const response=await authAxios.get(`${CART_SERVICE_URL}/api/v1/cart/`,{signal:controller.signal});if(!isMounted)return;const data=response.data;console.log('成功獲取購物車數據:',data);if(data.items){setCartItems(data.items.map(item=>({id:item.ProductID,name:item.Name,price:item.Price,quantity:item.Quantity,image:item.Image||\"https://via.placeholder.com/150\",stock:item.StockCount})));}}catch(error){if(error.name==='AbortError'||!isMounted)return;console.error('獲取購物車失敗:',error);showErrorMessage(error.message);}};getCartData();return()=>{isMounted=false;controller.abort();};},[authAxios,showErrorMessage]);// 修正 debounce 使用方式\nconst debouncedUpdateQuantity=useCallback((id,quantity)=>{// 將 debounce 函數移到 useCallback 內部\nconst updateQuantity=debounce(async(itemId,itemQuantity)=>{try{await authAxios.put(`${CART_SERVICE_URL}/api/v1/cart/items`,{ProductID:itemId,Quantity:itemQuantity});// 清除待更新狀態\nsetPendingUpdates(prev=>{const newUpdates={...prev};delete newUpdates[itemId];return newUpdates;});showSuccessMessage('數量已更新');}catch(error){console.error('更新數量失敗:',error);handleError(error);}},1000);updateQuantity(id,quantity);},[authAxios,showSuccessMessage,handleError]);// 處理數量變更\nconst handleQuantityChange=(id,newQuantity)=>{// 驗證輸入值\nconst quantity=Math.max(1,Math.min(99,Number(newQuantity)||1));// 更新本地狀態\nsetCartItems(prev=>prev.map(item=>item.id===id?{...item,quantity}:item));// 標記為待更新\nsetPendingUpdates(prev=>({...prev,[id]:quantity}));// 觸發防抖更新\ndebouncedUpdateQuantity(id,quantity);};// 移除商品\nconst removeItem=async id=>{try{await authAxios.delete(`${CART_SERVICE_URL}/api/v1/cart/items/${id}`);setCartItems(items=>items.filter(item=>item.id!==id));showSuccessMessage('商品已從購物車中移除');}catch(error){console.error('移除商品失敗:',error);handleError(error);}};// 清空購物車\nconst handleClearCart=async()=>{try{await authAxios.delete(`${CART_SERVICE_URL}/api/v1/cart/`);setCartItems([]);showSuccessMessage('購物車已清空');}catch(error){console.error('清空購物車失敗:',error);handleError(error);}};// 計算總金額\nconst total=cartItems.reduce((sum,item)=>sum+item.price*item.quantity,0);// 運費計算（訂單滿 2000 免運費）\nconst shippingFee=total>=2000?0:100;// 前往結帳\nconst handleCheckout=()=>{navigate('/checkout');};// 添加測試商品函數\nconst handleAddTestItem=async()=>{try{await authAxios.post(`${CART_SERVICE_URL}/api/v1/cart/items`,{productId:\"-OLlQJ2VgZvUgeVH75Vc\",quantity:1});await fetchCartData();// 使用我們定義的獨立函數來獲取購物車數據\nshowSuccessMessage('測試商品已添加到購物車');}catch(error){console.error('添加測試商品失敗:',error);handleError(error);}};// 立即更新的函數\nconst updateQuantityImmediately=useCallback(async(id,quantity)=>{try{await authAxios.put(`${CART_SERVICE_URL}/api/v1/cart/items`,{ProductID:id,Quantity:quantity});}catch(error){console.error('離開頁面時更新數量失敗:',error);}},[authAxios]);// 在組件卸載前確保所有更新都被發送\nuseEffect(()=>{return()=>{// 檢查所有待更新項目並立即發送\nObject.entries(pendingUpdates).forEach(_ref=>{let[id,quantity]=_ref;updateQuantityImmediately(id,quantity);});};},[pendingUpdates,updateQuantityImmediately]);return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:4,mb:4},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h4\",sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(CartIcon,{}),\" \\u8CFC\\u7269\\u8ECA\"]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleAddTestItem,startIcon:/*#__PURE__*/_jsx(AddShoppingCartIcon,{}),children:\"\\u65B0\\u589E\\u6E2C\\u8A66\\u5546\\u54C1\"}),cartItems.length>0&&/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"error\",onClick:handleClearCart,startIcon:/*#__PURE__*/_jsx(DeleteIcon,{}),children:\"\\u6E05\\u7A7A\\u8CFC\\u7269\\u8ECA\"})]})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:8,children:[/*#__PURE__*/_jsx(Collapse,{in:showAlert,children:/*#__PURE__*/_jsx(Alert,{severity:alertSeverity,sx:{mb:2},onClose:()=>setShowAlert(false),children:alertMessage})}),cartItems.length>0?cartItems.map(item=>/*#__PURE__*/_jsx(Fade,{in:true,children:/*#__PURE__*/_jsx(Card,{sx:{mb:2,position:'relative'},children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:3,children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,onError:e=>{var _item$image;console.error('圖片加載失敗:',(_item$image=item.image)===null||_item$image===void 0?void 0:_item$image.substring(0,50));e.target.src=\"https://via.placeholder.com/150\";},style:{width:'100%',height:'auto',borderRadius:'8px'}})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:9,children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'flex-start',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",children:item.name}),/*#__PURE__*/_jsx(IconButton,{color:\"error\",onClick:()=>removeItem(item.id),size:\"small\",children:/*#__PURE__*/_jsx(DeleteIcon,{})})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>handleQuantityChange(item.id,item.quantity-1),disabled:item.quantity<=1,children:/*#__PURE__*/_jsx(RemoveIcon,{})}),/*#__PURE__*/_jsx(TextField,{type:\"number\",value:item.quantity,onChange:e=>handleQuantityChange(item.id,e.target.value),inputProps:{min:1,max:99,step:1},sx:{width:'80px'},size:\"small\",variant:\"outlined\",onBlur:()=>{// 當輸入框失去焦點時立即更新\nif(pendingUpdates[item.id]){debouncedUpdateQuantity.flush();// 如果使用lodash的debounce，可以立即執行\n}}}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>handleQuantityChange(item.id,item.quantity+1),disabled:item.quantity>=item.stock,children:/*#__PURE__*/_jsx(AddIcon,{})})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:\"primary\",children:[\"NT$ \",item.price*item.quantity]})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"text.secondary\",children:[\"\\u5EAB\\u5B58: \",item.stock,\" \\u4EF6\"]}),pendingUpdates[item.id]&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:\"\\u66F4\\u65B0\\u4E2D...\"})]})]})})})},item.id)):/*#__PURE__*/_jsxs(Paper,{sx:{p:3,textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"\\u8CFC\\u7269\\u8ECA\\u662F\\u7A7A\\u7684\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",sx:{mt:2},onClick:()=>navigate('/products'),children:\"\\u7E7C\\u7E8C\\u8CFC\\u7269\"})]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(Paper,{sx:{p:3,position:'sticky',top:20},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\u8A02\\u55AE\\u6458\\u8981\"}),/*#__PURE__*/_jsxs(Box,{sx:{my:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:1},children:[/*#__PURE__*/_jsx(Typography,{children:\"\\u5546\\u54C1\\u7E3D\\u8A08\"}),/*#__PURE__*/_jsxs(Typography,{children:[\"NT$ \",total]})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:1,alignItems:'center'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(ShippingIcon,{fontSize:\"small\"}),/*#__PURE__*/_jsx(Typography,{children:\"\\u904B\\u8CBB\"})]}),/*#__PURE__*/_jsx(Typography,{children:shippingFee===0?'免運費':`NT$ ${shippingFee}`})]}),total<2000&&/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"primary\",children:[\"\\u9084\\u5DEE NT$ \",2000-total,\" \\u5373\\u53EF\\u4EAB\\u6709\\u514D\\u904B\\u512A\\u60E0\"]})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"\\u7E3D\\u8A08\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:\"primary\",children:[\"NT$ \",total+shippingFee]})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",fullWidth:true,size:\"large\",onClick:handleCheckout,disabled:cartItems.length===0,children:\"\\u524D\\u5F80\\u7D50\\u5E33\"})]})})]})]});};export default Cart;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Container","Paper","Typography","Box","IconButton","Button","Divider","Grid","Card","CardContent","TextField","Alert","Collapse","Fade","Add","AddIcon","Remove","RemoveIcon","Delete","DeleteIcon","ShoppingCart","CartIcon","LocalShipping","ShippingIcon","useNavigate","AddShoppingCartIcon","debounce","createAuthAxios","jsx","_jsx","jsxs","_jsxs","CART_SERVICE_URL","Cart","navigate","cartItems","setCartItems","showAlert","setShowAlert","alertMessage","setAlertMessage","alertSeverity","setAlertSeverity","pendingUpdates","setPendingUpdates","authAxios","useMemo","showSuccessMessage","message","setTimeout","showErrorMessage","handleError","error","_error$response","_error$response$data","response","data","fetchCartData","console","log","get","items","map","item","id","ProductID","name","Name","price","Price","quantity","Quantity","image","Image","stock","StockCount","isMounted","controller","AbortController","getCartData","signal","abort","debouncedUpdateQuantity","updateQuantity","itemId","itemQuantity","put","prev","newUpdates","handleQuantityChange","newQuantity","Math","max","min","Number","removeItem","delete","filter","handleClearCart","total","reduce","sum","shippingFee","handleCheckout","handleAddTestItem","post","productId","updateQuantityImmediately","Object","entries","forEach","_ref","maxWidth","sx","mt","mb","children","display","justifyContent","alignItems","variant","gap","color","onClick","startIcon","length","container","spacing","xs","md","in","severity","onClose","position","sm","src","alt","onError","e","_item$image","substring","target","style","width","height","borderRadius","component","size","disabled","type","value","onChange","inputProps","step","onBlur","flush","p","textAlign","top","gutterBottom","my","fontSize","fullWidth"],"sources":["/Users/sumingkai/Documents/OrderManagerSystem/frontend/src/pages/Store/Cart.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport {\n    Container,\n    Paper,\n    Typography,\n    Box,\n    IconButton,\n    Button,\n    Divider,\n    Grid,\n    Card,\n    CardContent,\n    TextField,\n    Alert,\n    Collapse,\n    Fade,\n} from '@mui/material';\nimport {\n    Add as AddIcon,\n    Remove as RemoveIcon,\n    Delete as DeleteIcon,\n    ShoppingCart as CartIcon,\n    LocalShipping as ShippingIcon,\n} from '@mui/icons-material';\nimport { useNavigate } from 'react-router-dom';\nimport AddShoppingCartIcon from '@mui/icons-material/AddShoppingCart';\nimport debounce from 'lodash/debounce';\nimport { createAuthAxios } from '../../utils/auth';\n\nconst CART_SERVICE_URL = 'https://ordermanagersystem.onrender.com';\n\nconst Cart = () => {\n    const navigate = useNavigate();\n    const [cartItems, setCartItems] = useState([]);\n    const [showAlert, setShowAlert] = useState(false);\n    const [alertMessage, setAlertMessage] = useState('');\n    const [alertSeverity, setAlertSeverity] = useState('success');\n    const [pendingUpdates, setPendingUpdates] = useState({});\n\n    // 使用 useMemo 記憶化 authAxios 實例\n    const authAxios = React.useMemo(() => createAuthAxios(navigate), [navigate]);\n\n    // 成功訊息顯示\n    const showSuccessMessage = useCallback((message) => {\n        setShowAlert(true);\n        setAlertMessage(message);\n        setAlertSeverity('success');\n        setTimeout(() => setShowAlert(false), 3000);\n    }, []);\n\n    // 錯誤訊息顯示\n    const showErrorMessage = useCallback((message) => {\n        setShowAlert(true);\n        setAlertMessage(message);\n        setAlertSeverity('error');\n        setTimeout(() => setShowAlert(false), 3000);\n    }, []);\n\n    // 錯誤處理函數\n    const handleError = useCallback((error) => {\n        // 不需要在這裡處理 401，已在 axios 實例中處理\n        showErrorMessage(error.response?.data?.error || '操作失敗');\n    }, [showErrorMessage]);\n\n    // 添加一個單獨的函數用於獲取購物車數據\n    const fetchCartData = useCallback(async () => {\n        try {\n            console.log('開始獲取購物車...');\n            const response = await authAxios.get(`${CART_SERVICE_URL}/api/v1/cart/`);\n\n            const data = response.data;\n            console.log('成功獲取購物車數據:', data);\n\n            if (data.items) {\n                setCartItems(data.items.map(item => ({\n                    id: item.ProductID,\n                    name: item.Name,\n                    price: item.Price,\n                    quantity: item.Quantity,\n                    image: item.Image || \"https://via.placeholder.com/150\",\n                    stock: item.StockCount\n                })));\n            }\n        } catch (error) {\n            console.error('獲取購物車失敗:', error);\n            showErrorMessage(error.message);\n        }\n    }, [authAxios, showErrorMessage]);\n\n    useEffect(() => {\n        let isMounted = true;\n        const controller = new AbortController();\n\n        const getCartData = async () => {\n            try {\n                console.log('開始獲取購物車...');\n                const response = await authAxios.get(`${CART_SERVICE_URL}/api/v1/cart/`, {\n                    signal: controller.signal\n                });\n\n                if (!isMounted) return;\n\n                const data = response.data;\n                console.log('成功獲取購物車數據:', data);\n\n                if (data.items) {\n                    setCartItems(data.items.map(item => ({\n                        id: item.ProductID,\n                        name: item.Name,\n                        price: item.Price,\n                        quantity: item.Quantity,\n                        image: item.Image || \"https://via.placeholder.com/150\",\n                        stock: item.StockCount\n                    })));\n                }\n            } catch (error) {\n                if (error.name === 'AbortError' || !isMounted) return;\n\n                console.error('獲取購物車失敗:', error);\n                showErrorMessage(error.message);\n            }\n        };\n\n        getCartData();\n\n        return () => {\n            isMounted = false;\n            controller.abort();\n        };\n    }, [authAxios, showErrorMessage]);\n\n    // 修正 debounce 使用方式\n    const debouncedUpdateQuantity = useCallback((id, quantity) => {\n        // 將 debounce 函數移到 useCallback 內部\n        const updateQuantity = debounce(async (itemId, itemQuantity) => {\n            try {\n                await authAxios.put(`${CART_SERVICE_URL}/api/v1/cart/items`, {\n                    ProductID: itemId,\n                    Quantity: itemQuantity\n                });\n\n                // 清除待更新狀態\n                setPendingUpdates(prev => {\n                    const newUpdates = { ...prev };\n                    delete newUpdates[itemId];\n                    return newUpdates;\n                });\n\n                showSuccessMessage('數量已更新');\n            } catch (error) {\n                console.error('更新數量失敗:', error);\n                handleError(error);\n            }\n        }, 1000);\n\n        updateQuantity(id, quantity);\n    }, [authAxios, showSuccessMessage, handleError]);\n\n    // 處理數量變更\n    const handleQuantityChange = (id, newQuantity) => {\n        // 驗證輸入值\n        const quantity = Math.max(1, Math.min(99, Number(newQuantity) || 1));\n\n        // 更新本地狀態\n        setCartItems(prev =>\n            prev.map(item =>\n                item.id === id ? { ...item, quantity } : item\n            )\n        );\n\n        // 標記為待更新\n        setPendingUpdates(prev => ({\n            ...prev,\n            [id]: quantity\n        }));\n\n        // 觸發防抖更新\n        debouncedUpdateQuantity(id, quantity);\n    };\n\n    // 移除商品\n    const removeItem = async (id) => {\n        try {\n            await authAxios.delete(`${CART_SERVICE_URL}/api/v1/cart/items/${id}`);\n            setCartItems(items => items.filter(item => item.id !== id));\n            showSuccessMessage('商品已從購物車中移除');\n        } catch (error) {\n            console.error('移除商品失敗:', error);\n            handleError(error);\n        }\n    };\n\n    // 清空購物車\n    const handleClearCart = async () => {\n        try {\n            await authAxios.delete(`${CART_SERVICE_URL}/api/v1/cart/`);\n            setCartItems([]);\n            showSuccessMessage('購物車已清空');\n        } catch (error) {\n            console.error('清空購物車失敗:', error);\n            handleError(error);\n        }\n    };\n\n    // 計算總金額\n    const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);\n\n    // 運費計算（訂單滿 2000 免運費）\n    const shippingFee = total >= 2000 ? 0 : 100;\n\n    // 前往結帳\n    const handleCheckout = () => {\n        navigate('/checkout');\n    };\n\n    // 添加測試商品函數\n    const handleAddTestItem = async () => {\n        try {\n            await authAxios.post(`${CART_SERVICE_URL}/api/v1/cart/items`, {\n                productId: \"-OLlQJ2VgZvUgeVH75Vc\",\n                quantity: 1\n            });\n            await fetchCartData(); // 使用我們定義的獨立函數來獲取購物車數據\n            showSuccessMessage('測試商品已添加到購物車');\n        } catch (error) {\n            console.error('添加測試商品失敗:', error);\n            handleError(error);\n        }\n    };\n\n    // 立即更新的函數\n    const updateQuantityImmediately = useCallback(async (id, quantity) => {\n        try {\n            await authAxios.put(`${CART_SERVICE_URL}/api/v1/cart/items`, {\n                ProductID: id,\n                Quantity: quantity\n            });\n        } catch (error) {\n            console.error('離開頁面時更新數量失敗:', error);\n        }\n    }, [authAxios]);\n\n    // 在組件卸載前確保所有更新都被發送\n    useEffect(() => {\n        return () => {\n            // 檢查所有待更新項目並立即發送\n            Object.entries(pendingUpdates).forEach(([id, quantity]) => {\n                updateQuantityImmediately(id, quantity);\n            });\n        };\n    }, [pendingUpdates, updateQuantityImmediately]);\n\n    return (\n        <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\n            <Box sx={{\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                mb: 2\n            }}>\n                <Typography variant=\"h4\" sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                    <CartIcon /> 購物車\n                </Typography>\n                <Box sx={{ display: 'flex', gap: 2 }}>\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        onClick={handleAddTestItem}\n                        startIcon={<AddShoppingCartIcon />}\n                    >\n                        新增測試商品\n                    </Button>\n                    {cartItems.length > 0 && (\n                        <Button\n                            variant=\"outlined\"\n                            color=\"error\"\n                            onClick={handleClearCart}\n                            startIcon={<DeleteIcon />}\n                        >\n                            清空購物車\n                        </Button>\n                    )}\n                </Box>\n            </Box>\n\n            <Grid container spacing={3}>\n                <Grid item xs={12} md={8}>\n                    <Collapse in={showAlert}>\n                        <Alert\n                            severity={alertSeverity}\n                            sx={{ mb: 2 }}\n                            onClose={() => setShowAlert(false)}\n                        >\n                            {alertMessage}\n                        </Alert>\n                    </Collapse>\n\n                    {cartItems.length > 0 ? (\n                        cartItems.map((item) => (\n                            <Fade in={true} key={item.id}>\n                                <Card sx={{ mb: 2, position: 'relative' }}>\n                                    <CardContent>\n                                        <Grid container spacing={2} alignItems=\"center\">\n                                            <Grid item xs={12} sm={3}>\n                                                <img\n                                                    src={item.image}\n                                                    alt={item.name}\n                                                    onError={(e) => {\n                                                        console.error('圖片加載失敗:', item.image?.substring(0, 50));\n                                                        e.target.src = \"https://via.placeholder.com/150\";\n                                                    }}\n                                                    style={{\n                                                        width: '100%',\n                                                        height: 'auto',\n                                                        borderRadius: '8px'\n                                                    }}\n                                                />\n                                            </Grid>\n                                            <Grid item xs={12} sm={9}>\n                                                <Box sx={{\n                                                    display: 'flex',\n                                                    justifyContent: 'space-between',\n                                                    alignItems: 'flex-start',\n                                                    mb: 2\n                                                }}>\n                                                    <Typography variant=\"h6\" component=\"div\">\n                                                        {item.name}\n                                                    </Typography>\n                                                    <IconButton\n                                                        color=\"error\"\n                                                        onClick={() => removeItem(item.id)}\n                                                        size=\"small\"\n                                                    >\n                                                        <DeleteIcon />\n                                                    </IconButton>\n                                                </Box>\n                                                <Box sx={{\n                                                    display: 'flex',\n                                                    justifyContent: 'space-between',\n                                                    alignItems: 'center'\n                                                }}>\n                                                    <Box sx={{\n                                                        display: 'flex',\n                                                        alignItems: 'center',\n                                                        gap: 1\n                                                    }}>\n                                                        <IconButton\n                                                            size=\"small\"\n                                                            onClick={() => handleQuantityChange(item.id, item.quantity - 1)}\n                                                            disabled={item.quantity <= 1}\n                                                        >\n                                                            <RemoveIcon />\n                                                        </IconButton>\n                                                        <TextField\n                                                            type=\"number\"\n                                                            value={item.quantity}\n                                                            onChange={(e) => handleQuantityChange(item.id, e.target.value)}\n                                                            inputProps={{\n                                                                min: 1,\n                                                                max: 99,\n                                                                step: 1\n                                                            }}\n                                                            sx={{ width: '80px' }}\n                                                            size=\"small\"\n                                                            variant=\"outlined\"\n                                                            onBlur={() => {\n                                                                // 當輸入框失去焦點時立即更新\n                                                                if (pendingUpdates[item.id]) {\n                                                                    debouncedUpdateQuantity.flush(); // 如果使用lodash的debounce，可以立即執行\n                                                                }\n                                                            }}\n                                                        />\n                                                        <IconButton\n                                                            size=\"small\"\n                                                            onClick={() => handleQuantityChange(item.id, item.quantity + 1)}\n                                                            disabled={item.quantity >= item.stock}\n                                                        >\n                                                            <AddIcon />\n                                                        </IconButton>\n                                                    </Box>\n                                                    <Typography variant=\"h6\" color=\"primary\">\n                                                        NT$ {item.price * item.quantity}\n                                                    </Typography>\n                                                </Box>\n                                                <Typography variant=\"caption\" color=\"text.secondary\">\n                                                    庫存: {item.stock} 件\n                                                </Typography>\n                                                {pendingUpdates[item.id] && (\n                                                    <Typography variant=\"caption\" color=\"text.secondary\">\n                                                        更新中...\n                                                    </Typography>\n                                                )}\n                                            </Grid>\n                                        </Grid>\n                                    </CardContent>\n                                </Card>\n                            </Fade>\n                        ))\n                    ) : (\n                        <Paper sx={{ p: 3, textAlign: 'center' }}>\n                            <Typography variant=\"h6\" color=\"text.secondary\">\n                                購物車是空的\n                            </Typography>\n                            <Button\n                                variant=\"contained\"\n                                sx={{ mt: 2 }}\n                                onClick={() => navigate('/products')}\n                            >\n                                繼續購物\n                            </Button>\n                        </Paper>\n                    )}\n                </Grid>\n\n                <Grid item xs={12} md={4}>\n                    <Paper sx={{ p: 3, position: 'sticky', top: 20 }}>\n                        <Typography variant=\"h6\" gutterBottom>\n                            訂單摘要\n                        </Typography>\n                        <Box sx={{ my: 2 }}>\n                            <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 1 }}>\n                                <Typography>商品總計</Typography>\n                                <Typography>NT$ {total}</Typography>\n                            </Box>\n                            <Box sx={{\n                                display: 'flex',\n                                justifyContent: 'space-between',\n                                mb: 1,\n                                alignItems: 'center'\n                            }}>\n                                <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                                    <ShippingIcon fontSize=\"small\" />\n                                    <Typography>運費</Typography>\n                                </Box>\n                                <Typography>\n                                    {shippingFee === 0 ? '免運費' : `NT$ ${shippingFee}`}\n                                </Typography>\n                            </Box>\n                            {total < 2000 && (\n                                <Typography variant=\"caption\" color=\"primary\">\n                                    還差 NT$ {2000 - total} 即可享有免運優惠\n                                </Typography>\n                            )}\n                        </Box>\n                        <Divider sx={{ my: 2 }} />\n                        <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 2 }}>\n                            <Typography variant=\"h6\">總計</Typography>\n                            <Typography variant=\"h6\" color=\"primary\">\n                                NT$ {total + shippingFee}\n                            </Typography>\n                        </Box>\n                        <Button\n                            variant=\"contained\"\n                            fullWidth\n                            size=\"large\"\n                            onClick={handleCheckout}\n                            disabled={cartItems.length === 0}\n                        >\n                            前往結帳\n                        </Button>\n                    </Paper>\n                </Grid>\n            </Grid>\n        </Container>\n    );\n};\n\nexport default Cart; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}