{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{Container,Grid,Box,Paper,Typography,Button,IconButton,Divider,Rating,TextField,Alert,Snackbar,CircularProgress,Breadcrumbs,Tabs,Tab,CardMedia}from'@mui/material';import{Add as AddIcon,Remove as RemoveIcon,Favorite as FavoriteIcon,FavoriteBorder as FavoriteBorderIcon,ShoppingCart as CartIcon,ArrowBack as ArrowBackIcon,Inventory as InventoryIcon}from'@mui/icons-material';import{Link,useParams,useNavigate}from'react-router-dom';import{styled}from'@mui/material/styles';import{createAuthAxios}from'../../utils/auth';// 服務URL常量\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PRODUCT_SERVICE_URL=process.env.REACT_APP_PRODUCT_SERVICE_URL||'https://ordermanagersystem-product-service.onrender.com';const CART_SERVICE_URL=process.env.REACT_APP_CART_SERVICE_URL||'https://ordermanagersystem.onrender.com';// 樣式組件\nconst ProductImage=styled(CardMedia)(_ref=>{let{theme}=_ref;return{height:500,borderRadius:theme.shape.borderRadius,backgroundColor:'#f8fafc',backgroundSize:'contain'};});const ThumbnailImage=styled(Paper)(_ref2=>{let{theme,selected}=_ref2;return{width:80,height:80,cursor:'pointer',transition:'all 0.2s',backgroundSize:'cover',backgroundPosition:'center',border:selected?`2px solid ${theme.palette.primary.main}`:'none','&:hover':{transform:'scale(1.05)'}};});const StockIndicator=styled(Box)(_ref3=>{let{theme,inStock}=_ref3;return{display:'inline-flex',alignItems:'center',padding:'4px 12px',borderRadius:16,backgroundColor:inStock?'#e8f5e9':'#ffebee',color:inStock?'#1b5e20':'#c62828',fontSize:'0.875rem',fontWeight:500,marginBottom:theme.spacing(2)};});const PriceDisplay=styled(Typography)(_ref4=>{let{theme}=_ref4;return{fontWeight:600,color:theme.palette.primary.main,marginBottom:theme.spacing(2)};});const TabPanel=_ref5=>{let{children,value,index,...other}=_ref5;return/*#__PURE__*/_jsx(\"div\",{role:\"tabpanel\",hidden:value!==index,id:`product-tabpanel-${index}`,\"aria-labelledby\":`product-tab-${index}`,...other,children:value===index&&/*#__PURE__*/_jsx(Box,{sx:{p:3},children:children})});};const ProductDetail=()=>{var _product$images$activ,_product$price;const{id}=useParams();const navigate=useNavigate();const[product,setProduct]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[quantity,setQuantity]=useState(1);const[activeImage,setActiveImage]=useState(0);const[tabValue,setTabValue]=useState(0);const[alertOpen,setAlertOpen]=useState(false);const[alertMessage,setAlertMessage]=useState('');const[alertSeverity,setAlertSeverity]=useState('success');const[isFavorite,setIsFavorite]=useState(false);const[categoryInfo,setCategoryInfo]=useState(null);// 創建授權axios客戶端\nconst authAxios=React.useMemo(()=>createAuthAxios(navigate),[navigate]);// 成功消息顯示\nconst showSuccessMessage=useCallback(message=>{setAlertMessage(message);setAlertSeverity('success');setAlertOpen(true);},[]);// 錯誤消息顯示\nconst showErrorMessage=useCallback(message=>{setAlertMessage(message);setAlertSeverity('error');setAlertOpen(true);},[]);// 獲取商品詳情\nuseEffect(()=>{const fetchProductDetail=async()=>{setLoading(true);try{const response=await authAxios.get(`${PRODUCT_SERVICE_URL}/api/v1/products/${id}`);// 檢查API響應格式\nif(response.data&&response.data.data){setProduct(response.data.data);}else{setProduct(response.data);}// 檢查該商品是否在收藏列表中\ncheckIfFavorite(id);}catch(err){console.error('獲取商品詳情失敗:',err);setError('無法加載商品詳情，請稍後再試');showErrorMessage('獲取商品詳情失敗');}finally{setLoading(false);}};fetchProductDetail();},[id,authAxios,showErrorMessage]);// 檢查商品是否在收藏列表中\nconst checkIfFavorite=useCallback(async productId=>{try{const response=await authAxios.get(`${CART_SERVICE_URL}/api/v1/wishlist`);if(response.data&&Array.isArray(response.data.items)){const isFav=response.data.items.some(item=>item.ProductID===productId);setIsFavorite(isFav);}}catch(err){console.error('檢查收藏狀態失敗:',err);}},[authAxios]);// 處理收藏切換\nconst handleToggleFavorite=async()=>{try{if(isFavorite){await authAxios.delete(`${CART_SERVICE_URL}/api/v1/wishlist/items/${id}`);showSuccessMessage('商品已從收藏列表移除');}else{await authAxios.post(`${CART_SERVICE_URL}/api/v1/wishlist/items`,{productId:id});showSuccessMessage('商品已加入收藏');}setIsFavorite(!isFavorite);}catch(err){console.error('切換收藏狀態失敗:',err);showErrorMessage('操作失敗，請稍後再試');}};// 處理數量變更\nconst handleQuantityChange=event=>{const value=parseInt(event.target.value,10);if(!isNaN(value)){if(product&&product.stock){setQuantity(Math.max(1,Math.min(value,product.stock)));}else{setQuantity(Math.max(1,value));}}};// 增減數量\nconst increaseQuantity=()=>{if(product&&product.stock&&quantity<product.stock){setQuantity(quantity+1);}else if(!product||!product.stock){setQuantity(quantity+1);}};const decreaseQuantity=()=>{if(quantity>1){setQuantity(quantity-1);}};// 添加到購物車\nconst addToCart=async()=>{try{await authAxios.post(`${CART_SERVICE_URL}/api/v1/cart/items`,{productId:id,quantity:quantity});showSuccessMessage('商品已添加到購物車');}catch(err){console.error('添加購物車失敗:',err);showErrorMessage('添加購物車失敗，請稍後再試');}};// 處理標籤切換\nconst handleTabChange=(event,newValue)=>{setTabValue(newValue);};// 返回上一頁\nconst handleGoBack=()=>{navigate(-1);};// 處理分類詳情獲取\nuseEffect(()=>{const fetchCategoryDetail=async()=>{if(product&&product.category&&typeof product.category==='string'){try{console.log('正在獲取分類詳情...');const response=await authAxios.get(`${PRODUCT_SERVICE_URL}/api/v1/categories/${product.category}`);console.log('分類詳情:',response.data);if(response.data){setCategoryInfo(response.data);}}catch(err){console.error('獲取分類詳情失敗:',err);}}};if(product){fetchCategoryDetail();}},[product,authAxios]);// 更新渲染分類的函數\nconst renderCategory=()=>{if(!product.category)return null;let categoryName='未知分類';// 處理不同的資料結構\nif(typeof product.category==='object'&&product.category.name){categoryName=product.category.name;}else if(categoryInfo&&categoryInfo.name){// 使用從API獲取的分類資訊\ncategoryName=categoryInfo.name;}else if(typeof product.category==='string'){// 如果還沒獲取到分類詳情，顯示ID\ncategoryName=product.category;}return/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:[\"\\u5206\\u985E: \",categoryName]});};if(loading){return/*#__PURE__*/_jsx(Container,{maxWidth:\"lg\",sx:{my:4},children:/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',alignItems:'center',height:'50vh'},children:/*#__PURE__*/_jsx(CircularProgress,{})})});}if(error){return/*#__PURE__*/_jsx(Container,{maxWidth:\"lg\",sx:{my:4},children:/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:error})});}if(!product){return/*#__PURE__*/_jsx(Container,{maxWidth:\"lg\",sx:{my:4},children:/*#__PURE__*/_jsx(Alert,{severity:\"warning\",children:\"\\u627E\\u4E0D\\u5230\\u8A72\\u5546\\u54C1\"})});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{my:4},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:4},children:[/*#__PURE__*/_jsxs(Breadcrumbs,{separator:\"\\u203A\",\"aria-label\":\"breadcrumb\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",style:{textDecoration:'none',color:'inherit'},children:\"\\u9996\\u9801\"}),/*#__PURE__*/_jsx(Link,{to:\"/store\",style:{textDecoration:'none',color:'inherit'},children:\"\\u5546\\u5E97\"}),/*#__PURE__*/_jsx(Typography,{color:\"text.primary\",children:product.name})]}),/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(ArrowBackIcon,{}),onClick:handleGoBack,sx:{mt:2},children:\"\\u8FD4\\u56DE\"})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:4,children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Box,{sx:{mb:2},children:/*#__PURE__*/_jsx(ProductImage,{image:product.images&&product.images.length>0?((_product$images$activ=product.images[activeImage])===null||_product$images$activ===void 0?void 0:_product$images$activ.url)||'/images/default-product.jpg':'/images/default-product.jpg'})}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',gap:2,mt:2,overflowX:'auto',pb:2},children:product.images&&product.images.map((image,index)=>/*#__PURE__*/_jsx(ThumbnailImage,{selected:activeImage===index,onClick:()=>setActiveImage(index),style:{backgroundImage:`url(${image.url||'/images/default-product.jpg'})`}},index))})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,md:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,sx:{fontWeight:700},children:product.name}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Rating,{value:product.rating||4.5,precision:0.5,readOnly:true}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{ml:1},children:[\"(\",product.reviewCount||0,\" \\u8A55\\u50F9)\"]})]}),/*#__PURE__*/_jsxs(StockIndicator,{inStock:product.stock>0,children:[/*#__PURE__*/_jsx(InventoryIcon,{fontSize:\"small\",sx:{mr:0.5}}),product.stock>0?'有庫存':'缺貨中']}),/*#__PURE__*/_jsxs(PriceDisplay,{variant:\"h4\",children:[\"$\",(_product$price=product.price)===null||_product$price===void 0?void 0:_product$price.toLocaleString()]}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:3},children:product.description}),/*#__PURE__*/_jsx(Divider,{sx:{mb:3}}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",sx:{mb:1},children:\"\\u6578\\u91CF\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(IconButton,{onClick:decreaseQuantity,disabled:quantity<=1,size:\"small\",children:/*#__PURE__*/_jsx(RemoveIcon,{})}),/*#__PURE__*/_jsx(TextField,{value:quantity,onChange:handleQuantityChange,variant:\"outlined\",size:\"small\",inputProps:{min:1,max:product.stock||99,style:{textAlign:'center'}},sx:{width:'80px'}}),/*#__PURE__*/_jsx(IconButton,{onClick:increaseQuantity,disabled:product.stock&&quantity>=product.stock,size:\"small\",children:/*#__PURE__*/_jsx(AddIcon,{})})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:2,mb:3},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",size:\"large\",startIcon:/*#__PURE__*/_jsx(CartIcon,{}),disabled:product.stock<=0,onClick:addToCart,fullWidth:true,children:\"\\u52A0\\u5165\\u8CFC\\u7269\\u8ECA\"}),/*#__PURE__*/_jsx(IconButton,{color:isFavorite?\"error\":\"default\",onClick:handleToggleFavorite,sx:{border:'1px solid',borderColor:'divider'},children:isFavorite?/*#__PURE__*/_jsx(FavoriteIcon,{}):/*#__PURE__*/_jsx(FavoriteBorderIcon,{})})]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:[\"\\u5546\\u54C1\\u7DE8\\u865F: \",product.id]}),renderCategory()]})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:6,mb:4},children:[/*#__PURE__*/_jsxs(Tabs,{value:tabValue,onChange:handleTabChange,\"aria-label\":\"product tabs\",sx:{borderBottom:1,borderColor:'divider'},children:[/*#__PURE__*/_jsx(Tab,{label:\"\\u5546\\u54C1\\u8A73\\u60C5\"}),/*#__PURE__*/_jsx(Tab,{label:\"\\u898F\\u683C\\u53C3\\u6578\"}),/*#__PURE__*/_jsx(Tab,{label:\"\\u9867\\u5BA2\\u8A55\\u50F9\"})]}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:0,children:/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:product.description})}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:1,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[product.attributes&&product.attributes.map((attr,index)=>/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,sm:6,children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',py:1},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[attr.name,\":\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:attr.value})]}),/*#__PURE__*/_jsx(Divider,{})]},index)),(!product.attributes||product.attributes.length===0)&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"\\u66AB\\u7121\\u898F\\u683C\\u53C3\\u6578\"})})]})}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:2,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"\\u66AB\\u7121\\u8A55\\u50F9\"})})]}),/*#__PURE__*/_jsx(Snackbar,{open:alertOpen,autoHideDuration:3000,onClose:()=>setAlertOpen(false),anchorOrigin:{vertical:'bottom',horizontal:'center'},children:/*#__PURE__*/_jsx(Alert,{onClose:()=>setAlertOpen(false),severity:alertSeverity,children:alertMessage})})]});};export default ProductDetail;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Container","Grid","Box","Paper","Typography","Button","IconButton","Divider","Rating","TextField","Alert","Snackbar","CircularProgress","Breadcrumbs","Tabs","Tab","CardMedia","Add","AddIcon","Remove","RemoveIcon","Favorite","FavoriteIcon","FavoriteBorder","FavoriteBorderIcon","ShoppingCart","CartIcon","ArrowBack","ArrowBackIcon","Inventory","InventoryIcon","Link","useParams","useNavigate","styled","createAuthAxios","jsx","_jsx","jsxs","_jsxs","PRODUCT_SERVICE_URL","process","env","REACT_APP_PRODUCT_SERVICE_URL","CART_SERVICE_URL","REACT_APP_CART_SERVICE_URL","ProductImage","_ref","theme","height","borderRadius","shape","backgroundColor","backgroundSize","ThumbnailImage","_ref2","selected","width","cursor","transition","backgroundPosition","border","palette","primary","main","transform","StockIndicator","_ref3","inStock","display","alignItems","padding","color","fontSize","fontWeight","marginBottom","spacing","PriceDisplay","_ref4","TabPanel","_ref5","children","value","index","other","role","hidden","id","sx","p","ProductDetail","_product$images$activ","_product$price","navigate","product","setProduct","loading","setLoading","error","setError","quantity","setQuantity","activeImage","setActiveImage","tabValue","setTabValue","alertOpen","setAlertOpen","alertMessage","setAlertMessage","alertSeverity","setAlertSeverity","isFavorite","setIsFavorite","categoryInfo","setCategoryInfo","authAxios","useMemo","showSuccessMessage","message","showErrorMessage","fetchProductDetail","response","get","data","checkIfFavorite","err","console","productId","Array","isArray","items","isFav","some","item","ProductID","handleToggleFavorite","delete","post","handleQuantityChange","event","parseInt","target","isNaN","stock","Math","max","min","increaseQuantity","decreaseQuantity","addToCart","handleTabChange","newValue","handleGoBack","fetchCategoryDetail","category","log","renderCategory","categoryName","name","variant","maxWidth","my","justifyContent","severity","mb","separator","to","style","textDecoration","startIcon","onClick","mt","container","xs","md","image","images","length","url","gap","overflowX","pb","map","backgroundImage","component","gutterBottom","rating","precision","readOnly","ml","reviewCount","mr","price","toLocaleString","description","disabled","size","onChange","inputProps","textAlign","fullWidth","borderColor","borderBottom","label","attributes","attr","sm","py","open","autoHideDuration","onClose","anchorOrigin","vertical","horizontal"],"sources":["/Users/sumingkai/Documents/OrderManagerSystem/frontend/src/pages/Store/ProductDetail.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport {\n    Container,\n    Grid,\n    Box,\n    Paper,\n    Typography,\n    Button,\n    IconButton,\n    Divider,\n    Rating,\n    TextField,\n    Alert,\n    Snackbar,\n    CircularProgress,\n    Breadcrumbs,\n    Tabs,\n    Tab,\n    CardMedia,\n} from '@mui/material';\nimport {\n    Add as AddIcon,\n    Remove as RemoveIcon,\n    Favorite as FavoriteIcon,\n    FavoriteBorder as FavoriteBorderIcon,\n    ShoppingCart as CartIcon,\n    ArrowBack as ArrowBackIcon,\n    Inventory as InventoryIcon,\n} from '@mui/icons-material';\nimport { Link, useParams, useNavigate } from 'react-router-dom';\nimport { styled } from '@mui/material/styles';\nimport { createAuthAxios } from '../../utils/auth';\n\n// 服務URL常量\nconst PRODUCT_SERVICE_URL = process.env.REACT_APP_PRODUCT_SERVICE_URL || 'https://ordermanagersystem-product-service.onrender.com';\nconst CART_SERVICE_URL = process.env.REACT_APP_CART_SERVICE_URL || 'https://ordermanagersystem.onrender.com';\n\n// 樣式組件\nconst ProductImage = styled(CardMedia)(({ theme }) => ({\n    height: 500,\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: '#f8fafc',\n    backgroundSize: 'contain',\n}));\n\nconst ThumbnailImage = styled(Paper)(({ theme, selected }) => ({\n    width: 80,\n    height: 80,\n    cursor: 'pointer',\n    transition: 'all 0.2s',\n    backgroundSize: 'cover',\n    backgroundPosition: 'center',\n    border: selected ? `2px solid ${theme.palette.primary.main}` : 'none',\n    '&:hover': {\n        transform: 'scale(1.05)',\n    },\n}));\n\nconst StockIndicator = styled(Box)(({ theme, inStock }) => ({\n    display: 'inline-flex',\n    alignItems: 'center',\n    padding: '4px 12px',\n    borderRadius: 16,\n    backgroundColor: inStock ? '#e8f5e9' : '#ffebee',\n    color: inStock ? '#1b5e20' : '#c62828',\n    fontSize: '0.875rem',\n    fontWeight: 500,\n    marginBottom: theme.spacing(2),\n}));\n\nconst PriceDisplay = styled(Typography)(({ theme }) => ({\n    fontWeight: 600,\n    color: theme.palette.primary.main,\n    marginBottom: theme.spacing(2),\n}));\n\nconst TabPanel = ({ children, value, index, ...other }) => (\n    <div\n        role=\"tabpanel\"\n        hidden={value !== index}\n        id={`product-tabpanel-${index}`}\n        aria-labelledby={`product-tab-${index}`}\n        {...other}\n    >\n        {value === index && <Box sx={{ p: 3 }}>{children}</Box>}\n    </div>\n);\n\nconst ProductDetail = () => {\n    const { id } = useParams();\n    const navigate = useNavigate();\n    const [product, setProduct] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const [quantity, setQuantity] = useState(1);\n    const [activeImage, setActiveImage] = useState(0);\n    const [tabValue, setTabValue] = useState(0);\n    const [alertOpen, setAlertOpen] = useState(false);\n    const [alertMessage, setAlertMessage] = useState('');\n    const [alertSeverity, setAlertSeverity] = useState('success');\n    const [isFavorite, setIsFavorite] = useState(false);\n    const [categoryInfo, setCategoryInfo] = useState(null);\n\n    // 創建授權axios客戶端\n    const authAxios = React.useMemo(() => createAuthAxios(navigate), [navigate]);\n\n    // 成功消息顯示\n    const showSuccessMessage = useCallback((message) => {\n        setAlertMessage(message);\n        setAlertSeverity('success');\n        setAlertOpen(true);\n    }, []);\n\n    // 錯誤消息顯示\n    const showErrorMessage = useCallback((message) => {\n        setAlertMessage(message);\n        setAlertSeverity('error');\n        setAlertOpen(true);\n    }, []);\n\n    // 獲取商品詳情\n    useEffect(() => {\n        const fetchProductDetail = async () => {\n            setLoading(true);\n            try {\n                const response = await authAxios.get(`${PRODUCT_SERVICE_URL}/api/v1/products/${id}`);\n\n                // 檢查API響應格式\n                if (response.data && response.data.data) {\n                    setProduct(response.data.data);\n                } else {\n                    setProduct(response.data);\n                }\n\n                // 檢查該商品是否在收藏列表中\n                checkIfFavorite(id);\n            } catch (err) {\n                console.error('獲取商品詳情失敗:', err);\n                setError('無法加載商品詳情，請稍後再試');\n                showErrorMessage('獲取商品詳情失敗');\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchProductDetail();\n    }, [id, authAxios, showErrorMessage]);\n\n    // 檢查商品是否在收藏列表中\n    const checkIfFavorite = useCallback(async (productId) => {\n        try {\n            const response = await authAxios.get(`${CART_SERVICE_URL}/api/v1/wishlist`);\n            if (response.data && Array.isArray(response.data.items)) {\n                const isFav = response.data.items.some(item => item.ProductID === productId);\n                setIsFavorite(isFav);\n            }\n        } catch (err) {\n            console.error('檢查收藏狀態失敗:', err);\n        }\n    }, [authAxios]);\n\n    // 處理收藏切換\n    const handleToggleFavorite = async () => {\n        try {\n            if (isFavorite) {\n                await authAxios.delete(`${CART_SERVICE_URL}/api/v1/wishlist/items/${id}`);\n                showSuccessMessage('商品已從收藏列表移除');\n            } else {\n                await authAxios.post(`${CART_SERVICE_URL}/api/v1/wishlist/items`, {\n                    productId: id,\n                });\n                showSuccessMessage('商品已加入收藏');\n            }\n            setIsFavorite(!isFavorite);\n        } catch (err) {\n            console.error('切換收藏狀態失敗:', err);\n            showErrorMessage('操作失敗，請稍後再試');\n        }\n    };\n\n    // 處理數量變更\n    const handleQuantityChange = (event) => {\n        const value = parseInt(event.target.value, 10);\n        if (!isNaN(value)) {\n            if (product && product.stock) {\n                setQuantity(Math.max(1, Math.min(value, product.stock)));\n            } else {\n                setQuantity(Math.max(1, value));\n            }\n        }\n    };\n\n    // 增減數量\n    const increaseQuantity = () => {\n        if (product && product.stock && quantity < product.stock) {\n            setQuantity(quantity + 1);\n        } else if (!product || !product.stock) {\n            setQuantity(quantity + 1);\n        }\n    };\n\n    const decreaseQuantity = () => {\n        if (quantity > 1) {\n            setQuantity(quantity - 1);\n        }\n    };\n\n    // 添加到購物車\n    const addToCart = async () => {\n        try {\n            await authAxios.post(`${CART_SERVICE_URL}/api/v1/cart/items`, {\n                productId: id,\n                quantity: quantity\n            });\n            showSuccessMessage('商品已添加到購物車');\n        } catch (err) {\n            console.error('添加購物車失敗:', err);\n            showErrorMessage('添加購物車失敗，請稍後再試');\n        }\n    };\n\n    // 處理標籤切換\n    const handleTabChange = (event, newValue) => {\n        setTabValue(newValue);\n    };\n\n    // 返回上一頁\n    const handleGoBack = () => {\n        navigate(-1);\n    };\n\n    // 處理分類詳情獲取\n    useEffect(() => {\n        const fetchCategoryDetail = async () => {\n            if (product && product.category && typeof product.category === 'string') {\n                try {\n                    console.log('正在獲取分類詳情...');\n                    const response = await authAxios.get(`${PRODUCT_SERVICE_URL}/api/v1/categories/${product.category}`);\n                    console.log('分類詳情:', response.data);\n                    if (response.data) {\n                        setCategoryInfo(response.data);\n                    }\n                } catch (err) {\n                    console.error('獲取分類詳情失敗:', err);\n                }\n            }\n        };\n\n        if (product) {\n            fetchCategoryDetail();\n        }\n    }, [product, authAxios]);\n\n    // 更新渲染分類的函數\n    const renderCategory = () => {\n        if (!product.category) return null;\n\n        let categoryName = '未知分類';\n\n        // 處理不同的資料結構\n        if (typeof product.category === 'object' && product.category.name) {\n            categoryName = product.category.name;\n        } else if (categoryInfo && categoryInfo.name) {\n            // 使用從API獲取的分類資訊\n            categoryName = categoryInfo.name;\n        } else if (typeof product.category === 'string') {\n            // 如果還沒獲取到分類詳情，顯示ID\n            categoryName = product.category;\n        }\n\n        return (\n            <Typography variant=\"subtitle2\" color=\"text.secondary\">\n                分類: {categoryName}\n            </Typography>\n        );\n    };\n\n    if (loading) {\n        return (\n            <Container maxWidth=\"lg\" sx={{ my: 4 }}>\n                <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '50vh' }}>\n                    <CircularProgress />\n                </Box>\n            </Container>\n        );\n    }\n\n    if (error) {\n        return (\n            <Container maxWidth=\"lg\" sx={{ my: 4 }}>\n                <Alert severity=\"error\">{error}</Alert>\n            </Container>\n        );\n    }\n\n    if (!product) {\n        return (\n            <Container maxWidth=\"lg\" sx={{ my: 4 }}>\n                <Alert severity=\"warning\">找不到該商品</Alert>\n            </Container>\n        );\n    }\n\n    return (\n        <Container maxWidth=\"lg\" sx={{ my: 4 }}>\n            {/* 麵包屑導航 */}\n            <Box sx={{ mb: 4 }}>\n                <Breadcrumbs separator=\"›\" aria-label=\"breadcrumb\">\n                    <Link\n                        to=\"/\"\n                        style={{ textDecoration: 'none', color: 'inherit' }}\n                    >\n                        首頁\n                    </Link>\n                    <Link\n                        to=\"/store\"\n                        style={{ textDecoration: 'none', color: 'inherit' }}\n                    >\n                        商店\n                    </Link>\n                    <Typography color=\"text.primary\">{product.name}</Typography>\n                </Breadcrumbs>\n                <Button\n                    startIcon={<ArrowBackIcon />}\n                    onClick={handleGoBack}\n                    sx={{ mt: 2 }}\n                >\n                    返回\n                </Button>\n            </Box>\n\n            <Grid container spacing={4}>\n                {/* 商品圖片 */}\n                <Grid item xs={12} md={6}>\n                    <Box sx={{ mb: 2 }}>\n                        <ProductImage\n                            image={product.images && product.images.length > 0\n                                ? product.images[activeImage]?.url || '/images/default-product.jpg'\n                                : '/images/default-product.jpg'\n                            }\n                        />\n                    </Box>\n                    {/* 縮略圖 */}\n                    <Box sx={{ display: 'flex', gap: 2, mt: 2, overflowX: 'auto', pb: 2 }}>\n                        {product.images && product.images.map((image, index) => (\n                            <ThumbnailImage\n                                key={index}\n                                selected={activeImage === index}\n                                onClick={() => setActiveImage(index)}\n                                style={{\n                                    backgroundImage: `url(${image.url || '/images/default-product.jpg'})`\n                                }}\n                            />\n                        ))}\n                    </Box>\n                </Grid>\n\n                {/* 商品詳情 */}\n                <Grid item xs={12} md={6}>\n                    <Typography variant=\"h4\" component=\"h1\" gutterBottom sx={{ fontWeight: 700 }}>\n                        {product.name}\n                    </Typography>\n\n                    <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n                        <Rating\n                            value={product.rating || 4.5}\n                            precision={0.5}\n                            readOnly\n                        />\n                        <Typography variant=\"body2\" color=\"text.secondary\" sx={{ ml: 1 }}>\n                            ({product.reviewCount || 0} 評價)\n                        </Typography>\n                    </Box>\n\n                    <StockIndicator inStock={product.stock > 0}>\n                        <InventoryIcon fontSize=\"small\" sx={{ mr: 0.5 }} />\n                        {product.stock > 0 ? '有庫存' : '缺貨中'}\n                    </StockIndicator>\n\n                    <PriceDisplay variant=\"h4\">\n                        ${product.price?.toLocaleString()}\n                    </PriceDisplay>\n\n                    <Typography variant=\"body1\" sx={{ mb: 3 }}>\n                        {product.description}\n                    </Typography>\n\n                    <Divider sx={{ mb: 3 }} />\n\n                    {/* 數量選擇和加入購物車 */}\n                    <Box sx={{ mb: 3 }}>\n                        <Typography variant=\"subtitle1\" sx={{ mb: 1 }}>\n                            數量\n                        </Typography>\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                            <IconButton\n                                onClick={decreaseQuantity}\n                                disabled={quantity <= 1}\n                                size=\"small\"\n                            >\n                                <RemoveIcon />\n                            </IconButton>\n                            <TextField\n                                value={quantity}\n                                onChange={handleQuantityChange}\n                                variant=\"outlined\"\n                                size=\"small\"\n                                inputProps={{ min: 1, max: product.stock || 99, style: { textAlign: 'center' } }}\n                                sx={{ width: '80px' }}\n                            />\n                            <IconButton\n                                onClick={increaseQuantity}\n                                disabled={product.stock && quantity >= product.stock}\n                                size=\"small\"\n                            >\n                                <AddIcon />\n                            </IconButton>\n                        </Box>\n                    </Box>\n\n                    <Box sx={{ display: 'flex', gap: 2, mb: 3 }}>\n                        <Button\n                            variant=\"contained\"\n                            size=\"large\"\n                            startIcon={<CartIcon />}\n                            disabled={product.stock <= 0}\n                            onClick={addToCart}\n                            fullWidth\n                        >\n                            加入購物車\n                        </Button>\n                        <IconButton\n                            color={isFavorite ? \"error\" : \"default\"}\n                            onClick={handleToggleFavorite}\n                            sx={{ border: '1px solid', borderColor: 'divider' }}\n                        >\n                            {isFavorite ? <FavoriteIcon /> : <FavoriteBorderIcon />}\n                        </IconButton>\n                    </Box>\n\n                    <Box sx={{ mb: 3 }}>\n                        <Typography variant=\"subtitle2\" color=\"text.secondary\">\n                            商品編號: {product.id}\n                        </Typography>\n                        {renderCategory()}\n                    </Box>\n                </Grid>\n            </Grid>\n\n            {/* 詳細內容標籤 */}\n            <Box sx={{ mt: 6, mb: 4 }}>\n                <Tabs\n                    value={tabValue}\n                    onChange={handleTabChange}\n                    aria-label=\"product tabs\"\n                    sx={{ borderBottom: 1, borderColor: 'divider' }}\n                >\n                    <Tab label=\"商品詳情\" />\n                    <Tab label=\"規格參數\" />\n                    <Tab label=\"顧客評價\" />\n                </Tabs>\n\n                <TabPanel value={tabValue} index={0}>\n                    <Typography variant=\"body1\">\n                        {product.description}\n                    </Typography>\n                </TabPanel>\n\n                <TabPanel value={tabValue} index={1}>\n                    <Grid container spacing={2}>\n                        {product.attributes && product.attributes.map((attr, index) => (\n                            <Grid item xs={12} sm={6} key={index}>\n                                <Box sx={{ display: 'flex', justifyContent: 'space-between', py: 1 }}>\n                                    <Typography variant=\"body2\" color=\"text.secondary\">\n                                        {attr.name}:\n                                    </Typography>\n                                    <Typography variant=\"body2\">\n                                        {attr.value}\n                                    </Typography>\n                                </Box>\n                                <Divider />\n                            </Grid>\n                        ))}\n                        {(!product.attributes || product.attributes.length === 0) && (\n                            <Grid item xs={12}>\n                                <Typography variant=\"body2\" color=\"text.secondary\">\n                                    暫無規格參數\n                                </Typography>\n                            </Grid>\n                        )}\n                    </Grid>\n                </TabPanel>\n\n                <TabPanel value={tabValue} index={2}>\n                    <Typography variant=\"body2\" color=\"text.secondary\">\n                        暫無評價\n                    </Typography>\n                </TabPanel>\n            </Box>\n\n            {/* 成功/錯誤提示 */}\n            <Snackbar\n                open={alertOpen}\n                autoHideDuration={3000}\n                onClose={() => setAlertOpen(false)}\n                anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n            >\n                <Alert onClose={() => setAlertOpen(false)} severity={alertSeverity}>\n                    {alertMessage}\n                </Alert>\n            </Snackbar>\n        </Container>\n    );\n};\n\nexport default ProductDetail; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}