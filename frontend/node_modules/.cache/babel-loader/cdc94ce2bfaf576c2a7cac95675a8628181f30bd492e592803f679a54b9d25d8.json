{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{Box,Container,Paper,TextField,Button,Typography,Alert,Link,Divider}from'@mui/material';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'https://ordermanagersystem-auth-service.onrender.com';// 創建一個 axios 實例\nconst api=axios.create({baseURL:API_URL,headers:{'Content-Type':'application/json','Accept':'*/*'},withCredentials:false});const Login=()=>{const navigate=useNavigate();const[formData,setFormData]=useState({email:'admin@example.com',password:'password123'});const[error,setError]=useState('');const[isLoading,setIsLoading]=useState(false);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleLogin=async e=>{e.preventDefault();setError('');setIsLoading(true);try{const response=await api.post('/api/v1/auth/login',formData);const{token,user}=response.data;if(token){localStorage.setItem('userToken',token);localStorage.setItem('userData',JSON.stringify(user));const redirectUrl=sessionStorage.getItem('redirectUrl');sessionStorage.removeItem('redirectUrl');navigate(redirectUrl||'/');}else{throw new Error('登入回應中沒有 token');}}catch(err){var _err$response,_err$response$data;console.error('Login error:',err);setError((_err$response=err.response)!==null&&_err$response!==void 0&&(_err$response$data=_err$response.data)!==null&&_err$response$data!==void 0&&_err$response$data.message||err.message==='Network Error'?'無法連接到伺服器，請檢查您的網路連接':'登入失敗，請檢查您的帳號密碼是否正確');}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(Container,{component:\"main\",maxWidth:\"xs\",children:/*#__PURE__*/_jsx(Box,{sx:{marginTop:8,marginBottom:8,display:'flex',flexDirection:'column',alignItems:'center'},children:/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{padding:4,display:'flex',flexDirection:'column',alignItems:'center',width:'100%'},children:[/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h5\",sx:{mb:3},children:\"\\u6703\\u54E1\\u767B\\u5165\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{width:'100%',mb:2},children:error}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleLogin,sx:{width:'100%'},children:[/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"email\",label:\"\\u96FB\\u5B50\\u90F5\\u4EF6\",name:\"email\",autoComplete:\"email\",autoFocus:true,value:formData.email,onChange:handleChange}),/*#__PURE__*/_jsx(TextField,{margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"\\u5BC6\\u78BC\",type:\"password\",id:\"password\",autoComplete:\"current-password\",value:formData.password,onChange:handleChange}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2},disabled:isLoading,children:isLoading?'登入中...':'登入'}),/*#__PURE__*/_jsx(Divider,{sx:{my:2},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"\\u6216\"})}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Link,{component:\"button\",variant:\"body2\",onClick:()=>navigate('/register'),sx:{mb:1},children:\"\\u9084\\u6C92\\u6709\\u5E33\\u865F\\uFF1F\\u7ACB\\u5373\\u8A3B\\u518A\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Link,{component:\"button\",variant:\"body2\",onClick:()=>navigate('/forgot-password'),children:\"\\u5FD8\\u8A18\\u5BC6\\u78BC\\uFF1F\"})]})]})]})})});};export default Login;","map":{"version":3,"names":["React","useState","axios","Box","Container","Paper","TextField","Button","Typography","Alert","Link","Divider","useNavigate","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","withCredentials","Login","navigate","formData","setFormData","email","password","error","setError","isLoading","setIsLoading","handleChange","e","target","name","value","handleLogin","preventDefault","response","post","token","user","data","localStorage","setItem","JSON","stringify","redirectUrl","sessionStorage","getItem","removeItem","Error","err","_err$response","_err$response$data","console","message","component","maxWidth","children","sx","marginTop","marginBottom","display","flexDirection","alignItems","elevation","padding","width","variant","mb","severity","onSubmit","margin","required","fullWidth","id","label","autoComplete","autoFocus","onChange","type","mt","disabled","my","color","textAlign","onClick"],"sources":["/Users/sumingkai/Documents/OrderManagerSystem/frontend/src/pages/Store/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport {\n    Box,\n    Container,\n    Paper,\n    TextField,\n    Button,\n    Typography,\n    Alert,\n    Link,\n    Divider,\n} from '@mui/material';\nimport { useNavigate } from 'react-router-dom';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'https://ordermanagersystem-auth-service.onrender.com';\n\n// 創建一個 axios 實例\nconst api = axios.create({\n    baseURL: API_URL,\n    headers: {\n        'Content-Type': 'application/json',\n        'Accept': '*/*'\n    },\n    withCredentials: false\n});\n\nconst Login = () => {\n    const navigate = useNavigate();\n    const [formData, setFormData] = useState({\n        email: 'admin@example.com',\n        password: 'password123',\n    });\n    const [error, setError] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n\n    const handleChange = (e) => {\n        setFormData({\n            ...formData,\n            [e.target.name]: e.target.value,\n        });\n    };\n\n    const handleLogin = async (e) => {\n        e.preventDefault();\n        setError('');\n        setIsLoading(true);\n\n        try {\n            const response = await api.post('/api/v1/auth/login', formData);\n            const { token, user } = response.data;\n\n            if (token) {\n                localStorage.setItem('userToken', token);\n                localStorage.setItem('userData', JSON.stringify(user));\n                const redirectUrl = sessionStorage.getItem('redirectUrl');\n                sessionStorage.removeItem('redirectUrl');\n                navigate(redirectUrl || '/');\n            } else {\n                throw new Error('登入回應中沒有 token');\n            }\n        } catch (err) {\n            console.error('Login error:', err);\n            setError(\n                err.response?.data?.message ||\n                    err.message === 'Network Error'\n                    ? '無法連接到伺服器，請檢查您的網路連接'\n                    : '登入失敗，請檢查您的帳號密碼是否正確'\n            );\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    return (\n        <Container component=\"main\" maxWidth=\"xs\">\n            <Box\n                sx={{\n                    marginTop: 8,\n                    marginBottom: 8,\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                }}\n            >\n                <Paper\n                    elevation={3}\n                    sx={{\n                        padding: 4,\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                        width: '100%',\n                    }}\n                >\n                    <Typography component=\"h1\" variant=\"h5\" sx={{ mb: 3 }}>\n                        會員登入\n                    </Typography>\n\n                    {error && (\n                        <Alert severity=\"error\" sx={{ width: '100%', mb: 2 }}>\n                            {error}\n                        </Alert>\n                    )}\n\n                    <Box component=\"form\" onSubmit={handleLogin} sx={{ width: '100%' }}>\n                        <TextField\n                            margin=\"normal\"\n                            required\n                            fullWidth\n                            id=\"email\"\n                            label=\"電子郵件\"\n                            name=\"email\"\n                            autoComplete=\"email\"\n                            autoFocus\n                            value={formData.email}\n                            onChange={handleChange}\n                        />\n                        <TextField\n                            margin=\"normal\"\n                            required\n                            fullWidth\n                            name=\"password\"\n                            label=\"密碼\"\n                            type=\"password\"\n                            id=\"password\"\n                            autoComplete=\"current-password\"\n                            value={formData.password}\n                            onChange={handleChange}\n                        />\n                        <Button\n                            type=\"submit\"\n                            fullWidth\n                            variant=\"contained\"\n                            sx={{ mt: 3, mb: 2 }}\n                            disabled={isLoading}\n                        >\n                            {isLoading ? '登入中...' : '登入'}\n                        </Button>\n\n                        <Divider sx={{ my: 2 }}>\n                            <Typography variant=\"body2\" color=\"text.secondary\">\n                                或\n                            </Typography>\n                        </Divider>\n\n                        <Box sx={{ textAlign: 'center' }}>\n                            <Link\n                                component=\"button\"\n                                variant=\"body2\"\n                                onClick={() => navigate('/register')}\n                                sx={{ mb: 1 }}\n                            >\n                                還沒有帳號？立即註冊\n                            </Link>\n                            <br />\n                            <Link\n                                component=\"button\"\n                                variant=\"body2\"\n                                onClick={() => navigate('/forgot-password')}\n                            >\n                                忘記密碼？\n                            </Link>\n                        </Box>\n                    </Box>\n                </Paper>\n            </Box>\n        </Container>\n    );\n};\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}